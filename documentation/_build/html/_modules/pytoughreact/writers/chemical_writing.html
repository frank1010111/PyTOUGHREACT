<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>pytoughreact.writers.chemical_writing &mdash; PyToughReact 0.0.15 documentation</title>
      <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
        <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
        <script src="../../../_static/doctools.js"></script>
        <script src="../../../_static/sphinx_highlight.js"></script>
    <script src="../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../../index.html" class="icon icon-home">
            PyToughReact
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Installation:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../installation.html">Installation</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Repository Code:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../modules.html">pytoughreact</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">PyToughReact</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../../index.html">Module code</a></li>
      <li class="breadcrumb-item active">pytoughreact.writers.chemical_writing</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <h1>Source code for pytoughreact.writers.chemical_writing</h1><div class="highlight"><pre>
<span></span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">MIT License</span>

<span class="sd">Copyright (c) [2022] [Temitope Ajayi]</span>

<span class="sd">Permission is hereby granted, free of charge, to any person obtaining a copy</span>
<span class="sd">of this software and associated documentation files (the &quot;Software&quot;), to deal</span>
<span class="sd">in the Software without restriction, including without limitation the rights</span>
<span class="sd">to use, copy, modify, merge, publish, distribute, sublicense, and/or sell</span>
<span class="sd">copies of the Software, and to permit persons to whom the Software is</span>
<span class="sd">furnished to do so, subject to the following conditions:</span>

<span class="sd">The above copyright notice and this permission notice shall be included in all</span>
<span class="sd">copies or substantial portions of the Software.</span>

<span class="sd">THE SOFTWARE IS PROVIDED &quot;AS IS&quot;, WITHOUT WARRANTY OF ANY KIND, EXPRESS OR</span>
<span class="sd">IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,</span>
<span class="sd">FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE</span>
<span class="sd">AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER</span>
<span class="sd">LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,</span>
<span class="sd">OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE</span>
<span class="sd">SOFTWARE.</span>

<span class="sd">&#39;&#39;&#39;</span>

<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">copy</span>
<span class="kn">from</span> <span class="nn">t2data</span> <span class="kn">import</span> <span class="n">t2data</span>
<span class="kn">from</span> <span class="nn">fixed_format_file</span> <span class="kn">import</span> <span class="n">default_read_function</span><span class="p">,</span> <span class="n">fixed_format_file</span>
<span class="kn">from</span> <span class="nn">pytoughreact.constants.format_specifications</span> <span class="kn">import</span> <span class="n">t2chemical_format_specification</span>
<span class="kn">from</span> <span class="nn">pytoughreact.constants.sections</span> <span class="kn">import</span> <span class="n">t2chemical_sections</span>
<span class="kn">from</span> <span class="nn">pytoughreact.chemical.chemical_composition</span> <span class="kn">import</span> <span class="n">PrimarySpecies</span><span class="p">,</span> <span class="n">ReactGas</span><span class="p">,</span> <span class="n">Water</span><span class="p">,</span> <span class="n">WaterComp</span>
<span class="kn">from</span> <span class="nn">pytoughreact.chemical.mineral_description</span> <span class="kn">import</span> <span class="n">Mineral</span>
<span class="kn">from</span> <span class="nn">pytoughreact.chemical.mineral_composition</span> <span class="kn">import</span> <span class="n">MineralComp</span>
<span class="kn">from</span> <span class="nn">pytoughreact.chemical.mineral_zone</span> <span class="kn">import</span> <span class="n">MineralZone</span>
<span class="kn">from</span> <span class="nn">pytoughreact.chemical.perm_poro_zone</span> <span class="kn">import</span> <span class="n">PermPoro</span><span class="p">,</span> <span class="n">PermPoroZone</span>
<span class="kn">from</span> <span class="nn">pytoughreact.chemical.kinetic_properties</span> <span class="kn">import</span> <span class="n">pHDependenceType2</span><span class="p">,</span> <span class="n">Dissolution</span><span class="p">,</span> <span class="n">Precipitation</span><span class="p">,</span> <span class="n">pHDependenceType1</span>
<span class="kn">from</span> <span class="nn">pytoughreact.exceptions.custom_error</span> <span class="kn">import</span> <span class="n">MissingParameter</span>


<div class="viewcode-block" id="SynergyChemical"><a class="viewcode-back" href="../../../pytoughreact.writers.html#pytoughreact.writers.chemical_writing.SynergyChemical">[docs]</a><span class="k">class</span> <span class="nc">SynergyChemical</span><span class="p">(</span><span class="n">fixed_format_file</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Class for parsing CHEMICAL.INP data file.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span> <span class="n">mode</span><span class="p">,</span> <span class="n">read_function</span><span class="o">=</span><span class="n">default_read_function</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">SynergyChemical</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">mode</span><span class="p">,</span>
                                              <span class="n">t2chemical_format_specification</span><span class="p">,</span> <span class="n">read_function</span><span class="p">)</span>

<div class="viewcode-block" id="SynergyChemical.get_param_values"><a class="viewcode-back" href="../../../pytoughreact.writers.html#pytoughreact.writers.chemical_writing.SynergyChemical.get_param_values">[docs]</a>    <span class="k">def</span> <span class="nf">get_param_values</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">linetype</span><span class="p">):</span>
        <span class="n">line</span> <span class="o">=</span> <span class="s1">&#39;start&#39;</span>
        <span class="n">all_lines</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">while</span> <span class="n">line</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;&#39;*&quot;</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
            <span class="n">line</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">file</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span>
            <span class="n">particular_line</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parse_string</span><span class="p">(</span><span class="n">line</span><span class="p">,</span> <span class="n">linetype</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">line</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;&#39;*&quot;</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
                <span class="n">all_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">particular_line</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">all_lines</span></div>

<div class="viewcode-block" id="SynergyChemical.get_param_values_mineral"><a class="viewcode-back" href="../../../pytoughreact.writers.html#pytoughreact.writers.chemical_writing.SynergyChemical.get_param_values_mineral">[docs]</a>    <span class="k">def</span> <span class="nf">get_param_values_mineral</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">line</span> <span class="o">=</span> <span class="s1">&#39;start&#39;</span>
        <span class="n">all_lines</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">line</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">file</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span>
        <span class="k">while</span> <span class="n">line</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;&#39;*&quot;</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
            <span class="n">liner</span> <span class="o">=</span> <span class="p">(</span><span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">())</span>
            <span class="n">precip_presence</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">liner</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
            <span class="n">presence</span> <span class="o">=</span> <span class="nb">any</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">isalpha</span><span class="p">()</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">liner</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="k">if</span> <span class="n">presence</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
                <span class="n">mineral</span> <span class="o">=</span> <span class="n">Mineral</span><span class="p">(</span><span class="n">liner</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="nb">int</span><span class="p">(</span><span class="n">liner</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="nb">int</span><span class="p">(</span><span class="n">liner</span><span class="p">[</span><span class="mi">2</span><span class="p">]),</span> <span class="nb">int</span><span class="p">(</span><span class="n">liner</span><span class="p">[</span><span class="mi">3</span><span class="p">]),</span> <span class="nb">int</span><span class="p">(</span><span class="n">liner</span><span class="p">[</span><span class="mi">4</span><span class="p">]))</span>
                <span class="n">line</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">file</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span>
                <span class="n">liner</span> <span class="o">=</span> <span class="p">(</span><span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">())</span>
                <span class="n">read_dissolution</span> <span class="o">=</span> <span class="n">Dissolution</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">liner</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="nb">int</span><span class="p">(</span><span class="n">liner</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="nb">float</span><span class="p">(</span><span class="n">liner</span><span class="p">[</span><span class="mi">2</span><span class="p">]),</span> <span class="nb">float</span><span class="p">(</span><span class="n">liner</span><span class="p">[</span><span class="mi">3</span><span class="p">]),</span> <span class="nb">float</span><span class="p">(</span><span class="n">liner</span><span class="p">[</span><span class="mi">4</span><span class="p">]),</span>
                                               <span class="nb">float</span><span class="p">(</span><span class="n">liner</span><span class="p">[</span><span class="mi">5</span><span class="p">]),</span> <span class="nb">float</span><span class="p">(</span><span class="n">liner</span><span class="p">[</span><span class="mi">6</span><span class="p">]),</span> <span class="nb">float</span><span class="p">(</span><span class="n">liner</span><span class="p">[</span><span class="mi">7</span><span class="p">]))</span>
                <span class="n">type_of_pH</span> <span class="o">=</span> <span class="n">liner</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
                <span class="k">if</span> <span class="nb">int</span><span class="p">(</span><span class="n">type_of_pH</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">mineral</span><span class="o">.</span><span class="n">dissolution</span> <span class="o">=</span> <span class="p">[</span><span class="n">read_dissolution</span><span class="p">]</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">line</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">file</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span>
                    <span class="n">liner</span> <span class="o">=</span> <span class="p">(</span><span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">())</span>
                    <span class="k">if</span> <span class="n">liner</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">isnumeric</span><span class="p">():</span>
                        <span class="n">number_of_ph</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">liner</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
                        <span class="n">ph_deps</span> <span class="o">=</span> <span class="p">[]</span>
                        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">number_of_ph</span><span class="p">):</span>
                            <span class="n">line</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">file</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span>
                            <span class="n">liner</span> <span class="o">=</span> <span class="p">(</span><span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">())</span>
                            <span class="k">if</span> <span class="n">type_of_pH</span> <span class="o">==</span> <span class="s1">&#39;2&#39;</span><span class="p">:</span>
                                <span class="n">ph_dep</span> <span class="o">=</span> <span class="n">pHDependenceType2</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">liner</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="nb">float</span><span class="p">(</span><span class="n">liner</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="nb">int</span><span class="p">(</span><span class="n">liner</span><span class="p">[</span><span class="mi">2</span><span class="p">]),</span> <span class="n">liner</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="nb">float</span><span class="p">(</span><span class="n">liner</span><span class="p">[</span><span class="mi">4</span><span class="p">]))</span>
                            <span class="k">elif</span> <span class="n">type_of_pH</span> <span class="o">==</span> <span class="s1">&#39;1&#39;</span><span class="p">:</span>
                                <span class="n">ph_dep</span> <span class="o">=</span> <span class="n">pHDependenceType1</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">liner</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="nb">int</span><span class="p">(</span><span class="n">liner</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="nb">float</span><span class="p">(</span><span class="n">liner</span><span class="p">[</span><span class="mi">2</span><span class="p">]),</span> <span class="nb">int</span><span class="p">(</span><span class="n">liner</span><span class="p">[</span><span class="mi">3</span><span class="p">]))</span>
                            <span class="n">ph_deps</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ph_dep</span><span class="p">)</span>
                        <span class="n">read_dissolution</span><span class="o">.</span><span class="n">pHDependence</span> <span class="o">=</span> <span class="n">ph_deps</span>
                        <span class="n">mineral</span><span class="o">.</span><span class="n">dissolution</span> <span class="o">=</span> <span class="p">[</span><span class="n">read_dissolution</span><span class="p">]</span>
                <span class="n">presence</span> <span class="o">=</span> <span class="nb">any</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">isalpha</span><span class="p">()</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">liner</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
                <span class="k">if</span> <span class="n">precip_presence</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="n">line</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">file</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span>
                    <span class="n">liner</span> <span class="o">=</span> <span class="p">(</span><span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">())</span>
                    <span class="n">init_line</span> <span class="o">=</span> <span class="n">liner</span>
                    <span class="n">line</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">file</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span>
                    <span class="n">liner</span> <span class="o">=</span> <span class="p">(</span><span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">())</span>
                    <span class="n">liner</span> <span class="o">=</span> <span class="n">init_line</span> <span class="o">+</span> <span class="n">liner</span>
                    <span class="n">read_precipitation</span> <span class="o">=</span> <span class="n">Precipitation</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">liner</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="nb">int</span><span class="p">(</span><span class="n">liner</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="nb">float</span><span class="p">(</span><span class="n">liner</span><span class="p">[</span><span class="mi">2</span><span class="p">]),</span> <span class="nb">float</span><span class="p">(</span><span class="n">liner</span><span class="p">[</span><span class="mi">3</span><span class="p">]),</span>
                                                       <span class="nb">float</span><span class="p">(</span><span class="n">liner</span><span class="p">[</span><span class="mi">4</span><span class="p">]),</span> <span class="nb">float</span><span class="p">(</span><span class="n">liner</span><span class="p">[</span><span class="mi">5</span><span class="p">]),</span> <span class="nb">float</span><span class="p">(</span><span class="n">liner</span><span class="p">[</span><span class="mi">6</span><span class="p">]),</span>
                                                       <span class="nb">float</span><span class="p">(</span><span class="n">liner</span><span class="p">[</span><span class="mi">7</span><span class="p">]),</span> <span class="nb">float</span><span class="p">(</span><span class="n">liner</span><span class="p">[</span><span class="mi">8</span><span class="p">]),</span> <span class="nb">int</span><span class="p">(</span><span class="n">liner</span><span class="p">[</span><span class="mi">9</span><span class="p">]),</span> <span class="nb">float</span><span class="p">(</span><span class="n">liner</span><span class="p">[</span><span class="mi">10</span><span class="p">]),</span>
                                                       <span class="nb">float</span><span class="p">(</span><span class="n">liner</span><span class="p">[</span><span class="mi">11</span><span class="p">]),</span> <span class="nb">float</span><span class="p">(</span><span class="n">liner</span><span class="p">[</span><span class="mi">12</span><span class="p">]))</span>
                    <span class="n">mineral</span><span class="o">.</span><span class="n">precipitation</span> <span class="o">=</span> <span class="p">[</span><span class="n">read_precipitation</span><span class="p">]</span>
            <span class="n">all_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">mineral</span><span class="p">)</span>
            <span class="n">line</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">file</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">all_lines</span></div>

<div class="viewcode-block" id="SynergyChemical.get_param_values_gas"><a class="viewcode-back" href="../../../pytoughreact.writers.html#pytoughreact.writers.chemical_writing.SynergyChemical.get_param_values_gas">[docs]</a>    <span class="k">def</span> <span class="nf">get_param_values_gas</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">all_lines</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">line</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">file</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span>
        <span class="k">while</span> <span class="n">line</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;&#39;*&quot;</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
            <span class="n">liner</span> <span class="o">=</span> <span class="p">(</span><span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">())</span>
            <span class="n">react_gas</span> <span class="o">=</span> <span class="n">ReactGas</span><span class="p">(</span><span class="n">liner</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="nb">int</span><span class="p">(</span><span class="n">liner</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="mi">0</span><span class="p">)</span>
            <span class="n">all_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">react_gas</span><span class="p">)</span>
            <span class="n">line</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">file</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span>

        <span class="k">return</span> <span class="n">all_lines</span></div>

<div class="viewcode-block" id="SynergyChemical.get_param_values_surface_complex"><a class="viewcode-back" href="../../../pytoughreact.writers.html#pytoughreact.writers.chemical_writing.SynergyChemical.get_param_values_surface_complex">[docs]</a>    <span class="k">def</span> <span class="nf">get_param_values_surface_complex</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">all_lines</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="c1"># line = self.file.readline()</span>
        <span class="c1"># while line.startswith(&quot;&#39;*&quot;) is False:</span>
        <span class="c1">#     liner = (line.split())</span>

        <span class="k">return</span> <span class="n">all_lines</span></div>

<div class="viewcode-block" id="SynergyChemical.get_param_values_decay_species"><a class="viewcode-back" href="../../../pytoughreact.writers.html#pytoughreact.writers.chemical_writing.SynergyChemical.get_param_values_decay_species">[docs]</a>    <span class="k">def</span> <span class="nf">get_param_values_decay_species</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">all_lines</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="c1"># line = self.file.readline()</span>
        <span class="c1"># while line.startswith(&quot;&#39;*&quot;) is False:</span>
        <span class="c1">#     liner = (line.split())</span>

        <span class="k">return</span> <span class="n">all_lines</span></div>

<div class="viewcode-block" id="SynergyChemical.get_param_values_exchangeable_cations"><a class="viewcode-back" href="../../../pytoughreact.writers.html#pytoughreact.writers.chemical_writing.SynergyChemical.get_param_values_exchangeable_cations">[docs]</a>    <span class="k">def</span> <span class="nf">get_param_values_exchangeable_cations</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">all_lines</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="c1"># line = self.file.readline()</span>
        <span class="c1"># while line.startswith(&quot;&#39;*&quot;) is False:</span>
        <span class="c1">#     liner = (line.split())</span>

        <span class="k">return</span> <span class="n">all_lines</span></div>

<div class="viewcode-block" id="SynergyChemical.get_reactive_options"><a class="viewcode-back" href="../../../pytoughreact.writers.html#pytoughreact.writers.chemical_writing.SynergyChemical.get_reactive_options">[docs]</a>    <span class="k">def</span> <span class="nf">get_reactive_options</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">line</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">file</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span>
        <span class="n">line</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">file</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span>
        <span class="n">liner</span> <span class="o">=</span> <span class="p">(</span><span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">())</span>
        <span class="k">return</span> <span class="n">liner</span></div>

<div class="viewcode-block" id="SynergyChemical.get_reactive_constraints"><a class="viewcode-back" href="../../../pytoughreact.writers.html#pytoughreact.writers.chemical_writing.SynergyChemical.get_reactive_constraints">[docs]</a>    <span class="k">def</span> <span class="nf">get_reactive_constraints</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">line</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">file</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span>
        <span class="n">line</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">file</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span>
        <span class="n">liner</span> <span class="o">=</span> <span class="p">(</span><span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">())</span>
        <span class="k">return</span> <span class="n">liner</span></div>

<div class="viewcode-block" id="SynergyChemical.get_readio"><a class="viewcode-back" href="../../../pytoughreact.writers.html#pytoughreact.writers.chemical_writing.SynergyChemical.get_readio">[docs]</a>    <span class="k">def</span> <span class="nf">get_readio</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">all_values</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">6</span><span class="p">):</span>
            <span class="n">line</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">file</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span>
            <span class="n">liner</span> <span class="o">=</span> <span class="p">(</span><span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">())</span>
            <span class="n">all_values</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">liner</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

        <span class="k">return</span> <span class="n">all_values</span></div>

<div class="viewcode-block" id="SynergyChemical.get_weight_diffusion"><a class="viewcode-back" href="../../../pytoughreact.writers.html#pytoughreact.writers.chemical_writing.SynergyChemical.get_weight_diffusion">[docs]</a>    <span class="k">def</span> <span class="nf">get_weight_diffusion</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">line</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">file</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span>
        <span class="n">line</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">file</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span>
        <span class="n">liner</span> <span class="o">=</span> <span class="p">(</span><span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">())</span>
        <span class="k">return</span> <span class="n">liner</span></div>

<div class="viewcode-block" id="SynergyChemical.get_tolerance_values"><a class="viewcode-back" href="../../../pytoughreact.writers.html#pytoughreact.writers.chemical_writing.SynergyChemical.get_tolerance_values">[docs]</a>    <span class="k">def</span> <span class="nf">get_tolerance_values</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">line</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">file</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span>
        <span class="n">line</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">file</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span>
        <span class="n">liner</span> <span class="o">=</span> <span class="p">(</span><span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">())</span>
        <span class="k">return</span> <span class="n">liner</span></div>

<div class="viewcode-block" id="SynergyChemical.get_printout_options"><a class="viewcode-back" href="../../../pytoughreact.writers.html#pytoughreact.writers.chemical_writing.SynergyChemical.get_printout_options">[docs]</a>    <span class="k">def</span> <span class="nf">get_printout_options</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">line</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">file</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span>
        <span class="n">line</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">file</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span>
        <span class="n">liner</span> <span class="o">=</span> <span class="p">(</span><span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">())</span>
        <span class="k">return</span> <span class="n">liner</span></div>

<div class="viewcode-block" id="SynergyChemical.search_for_node_index"><a class="viewcode-back" href="../../../pytoughreact.writers.html#pytoughreact.writers.chemical_writing.SynergyChemical.search_for_node_index">[docs]</a>    <span class="k">def</span> <span class="nf">search_for_node_index</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">blocks</span><span class="p">,</span> <span class="n">nodes</span><span class="p">):</span>
        <span class="n">indexes</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">nodes</span><span class="p">)):</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">blocks</span><span class="p">)):</span>
                <span class="k">if</span> <span class="n">blocks</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="n">nodes</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span>
                    <span class="n">indexes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">j</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">indexes</span></div>

<div class="viewcode-block" id="SynergyChemical.get_nodes_to_read"><a class="viewcode-back" href="../../../pytoughreact.writers.html#pytoughreact.writers.chemical_writing.SynergyChemical.get_nodes_to_read">[docs]</a>    <span class="k">def</span> <span class="nf">get_nodes_to_read</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">grid</span><span class="p">):</span>
        <span class="n">all_values</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">line</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">file</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span>
        <span class="k">while</span> <span class="nb">len</span><span class="p">(</span><span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">all_values</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">line</span><span class="o">.</span><span class="n">rstrip</span><span class="p">())</span>
            <span class="n">line</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">file</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span>

        <span class="n">output</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">search_for_node_index</span><span class="p">(</span><span class="n">grid</span><span class="o">.</span><span class="n">blocklist</span><span class="p">,</span> <span class="n">all_values</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">output</span></div>

<div class="viewcode-block" id="SynergyChemical.get_primary_species_to_read"><a class="viewcode-back" href="../../../pytoughreact.writers.html#pytoughreact.writers.chemical_writing.SynergyChemical.get_primary_species_to_read">[docs]</a>    <span class="k">def</span> <span class="nf">get_primary_species_to_read</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">primary_aqueous</span><span class="p">):</span>
        <span class="n">all_values</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">line</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">file</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span>
        <span class="k">while</span> <span class="nb">len</span><span class="p">(</span><span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">specie</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">find_primary_aqueous</span><span class="p">(</span><span class="n">primary_aqueous</span><span class="p">,</span> <span class="n">line</span><span class="o">.</span><span class="n">rstrip</span><span class="p">())</span>
            <span class="n">all_values</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">specie</span><span class="p">)</span>
            <span class="n">line</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">file</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span>

        <span class="k">return</span> <span class="n">all_values</span></div>

<div class="viewcode-block" id="SynergyChemical.get_minerals_to_write"><a class="viewcode-back" href="../../../pytoughreact.writers.html#pytoughreact.writers.chemical_writing.SynergyChemical.get_minerals_to_write">[docs]</a>    <span class="k">def</span> <span class="nf">get_minerals_to_write</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">minerals</span><span class="p">):</span>
        <span class="n">all_values</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">line</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">file</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span>
        <span class="k">while</span> <span class="nb">len</span><span class="p">(</span><span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">specie</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">find_minerals</span><span class="p">(</span><span class="n">minerals</span><span class="p">,</span> <span class="n">line</span><span class="o">.</span><span class="n">rstrip</span><span class="p">())</span>
            <span class="n">all_values</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">specie</span><span class="p">)</span>
            <span class="n">line</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">file</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span>

        <span class="k">return</span> <span class="n">all_values</span></div>

<div class="viewcode-block" id="SynergyChemical.get_default_chemical_zones"><a class="viewcode-back" href="../../../pytoughreact.writers.html#pytoughreact.writers.chemical_writing.SynergyChemical.get_default_chemical_zones">[docs]</a>    <span class="k">def</span> <span class="nf">get_default_chemical_zones</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">line</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">file</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span>
        <span class="n">line</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">file</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span>
        <span class="n">line</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">file</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span>
        <span class="n">line</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">file</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span>
        <span class="n">liner</span> <span class="o">=</span> <span class="p">(</span><span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">())</span>
        <span class="k">return</span> <span class="n">liner</span></div>

<div class="viewcode-block" id="SynergyChemical.get_default_chemical_zone_to_nodes"><a class="viewcode-back" href="../../../pytoughreact.writers.html#pytoughreact.writers.chemical_writing.SynergyChemical.get_default_chemical_zone_to_nodes">[docs]</a>    <span class="k">def</span> <span class="nf">get_default_chemical_zone_to_nodes</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">line</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">file</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span>
        <span class="n">line</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">file</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span>
        <span class="n">line</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">file</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span>
        <span class="n">all_values</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">while</span> <span class="nb">len</span><span class="p">(</span><span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">grid_name</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">grid_name</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">5</span><span class="p">])</span>
            <span class="n">liner</span> <span class="o">=</span> <span class="p">(</span><span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">())</span>
            <span class="n">value</span> <span class="o">=</span> <span class="n">grid_name</span> <span class="o">+</span> <span class="n">liner</span><span class="p">[</span><span class="mi">2</span><span class="p">:]</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">value</span><span class="p">)):</span>
                <span class="n">value</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">value</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
            <span class="n">line</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">file</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span>
            <span class="n">all_values</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">all_values</span></div>

<div class="viewcode-block" id="SynergyChemical.find_primary_aqueous"><a class="viewcode-back" href="../../../pytoughreact.writers.html#pytoughreact.writers.chemical_writing.SynergyChemical.find_primary_aqueous">[docs]</a>    <span class="k">def</span> <span class="nf">find_primary_aqueous</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">primary_aqueous</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
        <span class="n">startIndex</span> <span class="o">=</span> <span class="n">name</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\&#39;</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">startIndex</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">name</span> <span class="o">=</span> <span class="n">name</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;&#39;&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">primary_aqueous</span><span class="p">)):</span>
            <span class="k">if</span> <span class="n">name</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="n">primary_aqueous</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">NAME</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">lower</span><span class="p">():</span>
                <span class="k">return</span> <span class="n">primary_aqueous</span><span class="p">[</span><span class="n">i</span><span class="p">]</span></div>

<div class="viewcode-block" id="SynergyChemical.get_param_values_ib_waters"><a class="viewcode-back" href="../../../pytoughreact.writers.html#pytoughreact.writers.chemical_writing.SynergyChemical.get_param_values_ib_waters">[docs]</a>    <span class="k">def</span> <span class="nf">get_param_values_ib_waters</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">primary_aqueous</span><span class="p">,</span> <span class="n">grid</span><span class="p">):</span>
        <span class="n">initial_waters_mapping</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">initial_waters_list</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">boundary_waters_mapping</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">boundary_waters_list</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">line</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">file</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span>
        <span class="n">liner</span> <span class="o">=</span> <span class="p">(</span><span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">())</span>
        <span class="n">number_of_initial_waters</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">liner</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">liner</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">number_of_boundary_waters</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">liner</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">line</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">file</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span>
        <span class="n">line</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">file</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span>
        <span class="n">liner</span> <span class="o">=</span> <span class="p">(</span><span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">())</span>
        <span class="n">counter</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">while</span> <span class="nb">int</span><span class="p">(</span><span class="n">liner</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">&lt;</span> <span class="n">number_of_initial_waters</span> <span class="o">+</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">counter</span> <span class="o">&lt;</span> <span class="n">number_of_initial_waters</span> <span class="o">+</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">water_num</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">liner</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="n">temp</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">liner</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
            <span class="n">pressure</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">liner</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
            <span class="n">line</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">file</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span>
            <span class="n">line</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">file</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span>
            <span class="n">all_comp</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">while</span> <span class="n">line</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;&#39;*&quot;</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
                <span class="n">liner</span> <span class="o">=</span> <span class="p">(</span><span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">())</span>
                <span class="n">specie</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">find_primary_aqueous</span><span class="p">(</span><span class="n">primary_aqueous</span><span class="p">,</span> <span class="n">liner</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
                <span class="n">all_comp</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">WaterComp</span><span class="p">(</span><span class="n">specie</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">liner</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="nb">float</span><span class="p">(</span><span class="n">liner</span><span class="p">[</span><span class="mi">2</span><span class="p">]),</span> <span class="nb">float</span><span class="p">(</span><span class="n">liner</span><span class="p">[</span><span class="mi">3</span><span class="p">]),</span> <span class="n">liner</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span> <span class="nb">float</span><span class="p">(</span><span class="n">liner</span><span class="p">[</span><span class="mi">5</span><span class="p">])))</span>
                <span class="n">line</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">file</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span>
            <span class="n">line</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">file</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span>
            <span class="n">line</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">file</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span>
            <span class="n">liner</span> <span class="o">=</span> <span class="p">(</span><span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">())</span>
            <span class="n">water_composition</span> <span class="o">=</span> <span class="p">[</span><span class="n">Water</span><span class="p">(</span><span class="n">all_comp</span><span class="p">,</span> <span class="n">temp</span><span class="p">,</span> <span class="n">pressure</span><span class="p">)]</span>
            <span class="c1"># grid.zonelist[water_num -1].water = water_composition</span>
            <span class="n">initial_waters_mapping</span><span class="p">[</span><span class="n">water_num</span><span class="p">]</span> <span class="o">=</span> <span class="n">water_composition</span>
            <span class="n">initial_waters_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">water_composition</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">liner</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">isnumeric</span><span class="p">()</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
                <span class="k">break</span>
            <span class="n">counter</span> <span class="o">=</span> <span class="n">counter</span> <span class="o">+</span> <span class="mi">1</span>
        <span class="n">counter</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">if</span> <span class="n">liner</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">isnumeric</span><span class="p">()</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">initial_waters_list</span><span class="p">,</span> <span class="n">boundary_waters_list</span><span class="p">,</span> <span class="n">initial_waters_mapping</span><span class="p">,</span> <span class="n">boundary_waters_mapping</span>
        <span class="k">while</span> <span class="nb">int</span><span class="p">(</span><span class="n">liner</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">&lt;</span> <span class="n">number_of_boundary_waters</span> <span class="o">+</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">counter</span> <span class="o">&lt;</span> <span class="n">number_of_boundary_waters</span> <span class="o">+</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">water_num</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">liner</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="n">temp</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">liner</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
            <span class="n">pressure</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">liner</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
            <span class="n">line</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">file</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span>
            <span class="n">line</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">file</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span>
            <span class="n">all_comp</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">while</span> <span class="n">line</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;&#39;*&quot;</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
                <span class="n">liner</span> <span class="o">=</span> <span class="p">(</span><span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">())</span>
                <span class="n">specie</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">find_primary_aqueous</span><span class="p">(</span><span class="n">primary_aqueous</span><span class="p">,</span> <span class="n">liner</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
                <span class="n">all_comp</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">WaterComp</span><span class="p">(</span><span class="n">specie</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">liner</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="nb">float</span><span class="p">(</span><span class="n">liner</span><span class="p">[</span><span class="mi">2</span><span class="p">]),</span> <span class="nb">float</span><span class="p">(</span><span class="n">liner</span><span class="p">[</span><span class="mi">3</span><span class="p">]),</span> <span class="n">liner</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span> <span class="nb">float</span><span class="p">(</span><span class="n">liner</span><span class="p">[</span><span class="mi">5</span><span class="p">])))</span>
                <span class="n">line</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">file</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span>
            <span class="n">line</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">file</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span>
            <span class="n">line</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">file</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span>
            <span class="n">liner</span> <span class="o">=</span> <span class="p">(</span><span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">())</span>
            <span class="n">water_composition</span> <span class="o">=</span> <span class="p">[</span><span class="n">Water</span><span class="p">(</span><span class="n">all_comp</span><span class="p">,</span> <span class="n">temp</span><span class="p">,</span> <span class="n">pressure</span><span class="p">)]</span>
            <span class="c1"># grid.zonelist[water_num -1].water = water_composition</span>
            <span class="n">boundary_waters_mapping</span><span class="p">[</span><span class="n">water_num</span><span class="p">]</span> <span class="o">=</span> <span class="n">water_composition</span>
            <span class="n">boundary_waters_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">water_composition</span><span class="p">)</span>
            <span class="n">counter</span> <span class="o">=</span> <span class="n">counter</span> <span class="o">+</span> <span class="mi">1</span>
            <span class="k">if</span> <span class="n">liner</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">isnumeric</span><span class="p">()</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
                <span class="k">break</span>

        <span class="k">return</span> <span class="n">initial_waters_list</span><span class="p">,</span> <span class="n">boundary_waters_list</span><span class="p">,</span> <span class="n">initial_waters_mapping</span><span class="p">,</span> <span class="n">boundary_waters_mapping</span></div>

<div class="viewcode-block" id="SynergyChemical.find_minerals"><a class="viewcode-back" href="../../../pytoughreact.writers.html#pytoughreact.writers.chemical_writing.SynergyChemical.find_minerals">[docs]</a>    <span class="k">def</span> <span class="nf">find_minerals</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">minerals</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
        <span class="n">startIndex</span> <span class="o">=</span> <span class="n">name</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\&#39;</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">startIndex</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">name</span> <span class="o">=</span> <span class="n">name</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;&#39;&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">minerals</span><span class="p">)):</span>
            <span class="k">if</span> <span class="n">name</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="n">minerals</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">lower</span><span class="p">():</span>
                <span class="k">return</span> <span class="n">minerals</span><span class="p">[</span><span class="n">i</span><span class="p">]</span></div>

<div class="viewcode-block" id="SynergyChemical.get_param_values_mineral_zones"><a class="viewcode-back" href="../../../pytoughreact.writers.html#pytoughreact.writers.chemical_writing.SynergyChemical.get_param_values_mineral_zones">[docs]</a>    <span class="k">def</span> <span class="nf">get_param_values_mineral_zones</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">minerals</span><span class="p">):</span>
        <span class="n">initial_minerals_mapping</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">initial_minerals_list</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">line</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">file</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span>
        <span class="n">liner</span> <span class="o">=</span> <span class="p">(</span><span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">())</span>
        <span class="n">number_of_mineral_zones</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">liner</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">line</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">file</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span>
        <span class="n">liner</span> <span class="o">=</span> <span class="p">(</span><span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">())</span>
        <span class="n">counter</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">while</span> <span class="nb">int</span><span class="p">(</span><span class="n">liner</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">&lt;</span> <span class="n">number_of_mineral_zones</span> <span class="o">+</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">counter</span> <span class="o">&lt;</span> <span class="n">number_of_mineral_zones</span> <span class="o">+</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">mineral_num</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">liner</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="n">line</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">file</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span>
            <span class="n">line</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">file</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span>
            <span class="n">all_comp</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">while</span> <span class="n">line</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;&#39;*&quot;</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
                <span class="n">liner</span> <span class="o">=</span> <span class="p">(</span><span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">())</span>
                <span class="n">initial_mineral_value</span> <span class="o">=</span> <span class="n">liner</span>
                <span class="n">mineral_found</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">find_minerals</span><span class="p">(</span><span class="n">minerals</span><span class="p">,</span> <span class="n">liner</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
                <span class="n">line</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">file</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span>
                <span class="n">liner</span> <span class="o">=</span> <span class="p">(</span><span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">())</span>
                <span class="n">initial_mineral_value</span> <span class="o">=</span> <span class="n">initial_mineral_value</span> <span class="o">+</span> <span class="n">liner</span>
                <span class="n">spec_mineral</span> <span class="o">=</span> <span class="n">MineralComp</span><span class="p">(</span><span class="n">mineral_found</span><span class="p">,</span> <span class="nb">float</span><span class="p">(</span><span class="n">initial_mineral_value</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="nb">int</span><span class="p">(</span><span class="n">initial_mineral_value</span><span class="p">[</span><span class="mi">2</span><span class="p">]),</span>
                                           <span class="nb">float</span><span class="p">(</span><span class="n">initial_mineral_value</span><span class="p">[</span><span class="mi">3</span><span class="p">]),</span> <span class="nb">float</span><span class="p">(</span><span class="n">initial_mineral_value</span><span class="p">[</span><span class="mi">4</span><span class="p">]),</span> <span class="nb">int</span><span class="p">(</span><span class="n">initial_mineral_value</span><span class="p">[</span><span class="mi">5</span><span class="p">]))</span>
                <span class="n">all_comp</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">spec_mineral</span><span class="p">)</span>
                <span class="n">line</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">file</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span>
            <span class="n">line</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">file</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span>
            <span class="n">liner</span> <span class="o">=</span> <span class="p">(</span><span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">())</span>
            <span class="c1"># grid.zonelist[mineral_num -1].mineral_zone = MineralZone(all_comp)</span>
            <span class="n">initial_minerals_mapping</span><span class="p">[</span><span class="n">mineral_num</span><span class="p">]</span> <span class="o">=</span> <span class="n">MineralZone</span><span class="p">(</span><span class="n">all_comp</span><span class="p">)</span>
            <span class="n">initial_minerals_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">MineralZone</span><span class="p">(</span><span class="n">all_comp</span><span class="p">))</span>
            <span class="n">counter</span> <span class="o">=</span> <span class="n">counter</span> <span class="o">+</span> <span class="mi">1</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">liner</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">break</span>

        <span class="k">return</span> <span class="n">initial_minerals_list</span><span class="p">,</span> <span class="n">initial_minerals_mapping</span></div>

<div class="viewcode-block" id="SynergyChemical.find_gas"><a class="viewcode-back" href="../../../pytoughreact.writers.html#pytoughreact.writers.chemical_writing.SynergyChemical.find_gas">[docs]</a>    <span class="k">def</span> <span class="nf">find_gas</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">gases</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
        <span class="n">startIndex</span> <span class="o">=</span> <span class="n">name</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\&#39;</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">startIndex</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">name</span> <span class="o">=</span> <span class="n">name</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;&#39;&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">gases</span><span class="p">)):</span>
            <span class="k">if</span> <span class="n">name</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="n">gases</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">lower</span><span class="p">():</span>
                <span class="k">return</span> <span class="n">gases</span><span class="p">[</span><span class="n">i</span><span class="p">]</span></div>

<div class="viewcode-block" id="SynergyChemical.get_param_values_ij_gases"><a class="viewcode-back" href="../../../pytoughreact.writers.html#pytoughreact.writers.chemical_writing.SynergyChemical.get_param_values_ij_gases">[docs]</a>    <span class="k">def</span> <span class="nf">get_param_values_ij_gases</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">gases</span><span class="p">):</span>
        <span class="n">initial_gas_mapping</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">initial_gas_list</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">injection_gas_mapping</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">injection_gas_list</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">line</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">file</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span>
        <span class="n">liner</span> <span class="o">=</span> <span class="p">(</span><span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">())</span>
        <span class="n">number_of_initial_gas</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">liner</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">liner</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">number_of_injection_gas</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">liner</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">line</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">file</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span>
        <span class="n">liner</span> <span class="o">=</span> <span class="p">(</span><span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">())</span>
        <span class="n">counter</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">while</span> <span class="nb">int</span><span class="p">(</span><span class="n">liner</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">&lt;</span> <span class="n">number_of_initial_gas</span> <span class="o">+</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">counter</span> <span class="o">&lt;</span> <span class="n">number_of_initial_gas</span> <span class="o">+</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">gas_num</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">liner</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="n">line</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">file</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span>
            <span class="n">line</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">file</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span>
            <span class="n">all_comp</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">while</span> <span class="n">line</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;&#39;*&quot;</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
                <span class="n">liner</span> <span class="o">=</span> <span class="p">(</span><span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">())</span>
                <span class="n">spec_gas</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">find_gas</span><span class="p">(</span><span class="n">gases</span><span class="p">,</span> <span class="n">liner</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
                <span class="n">spec_gas</span><span class="o">.</span><span class="n">partial_pressure</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">liner</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
                <span class="n">all_comp</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">spec_gas</span><span class="p">)</span>
                <span class="n">line</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">file</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span>
            <span class="n">line</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">file</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span>
            <span class="n">liner</span> <span class="o">=</span> <span class="p">(</span><span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">())</span>
            <span class="c1"># grid.zonelist[gas_num -1].gas = spec_gas</span>
            <span class="n">initial_gas_mapping</span><span class="p">[</span><span class="n">gas_num</span><span class="p">]</span> <span class="o">=</span> <span class="n">spec_gas</span>
            <span class="n">initial_gas_list</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">spec_gas</span><span class="p">])</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">liner</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">break</span>
            <span class="n">counter</span> <span class="o">=</span> <span class="n">counter</span> <span class="o">+</span> <span class="mi">1</span>
        <span class="n">counter</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">liner</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">initial_gas_list</span><span class="p">,</span> <span class="n">injection_gas_list</span><span class="p">,</span> <span class="n">initial_gas_mapping</span><span class="p">,</span> <span class="n">injection_gas_mapping</span>
        <span class="k">while</span> <span class="nb">int</span><span class="p">(</span><span class="n">liner</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">&lt;</span> <span class="n">number_of_injection_gas</span> <span class="o">+</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">counter</span> <span class="o">&lt;</span> <span class="n">number_of_injection_gas</span> <span class="o">+</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">gas_num</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">liner</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="n">line</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">file</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span>
            <span class="n">line</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">file</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span>
            <span class="n">all_comp</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">while</span> <span class="n">line</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;&#39;*&quot;</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
                <span class="n">liner</span> <span class="o">=</span> <span class="p">(</span><span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">())</span>
                <span class="n">spec_gas2</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">find_gas</span><span class="p">(</span><span class="n">gases</span><span class="p">,</span> <span class="n">liner</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
                <span class="n">spec_gas2</span><span class="o">.</span><span class="n">partial_pressure</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">liner</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
                <span class="n">all_comp</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">spec_gas2</span><span class="p">)</span>
                <span class="n">line</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">file</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span>
            <span class="n">line</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">file</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span>
            <span class="n">liner</span> <span class="o">=</span> <span class="p">(</span><span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">())</span>
            <span class="c1"># grid.zonelist[gas_num -1].gas = spec_gas</span>
            <span class="n">injection_gas_mapping</span><span class="p">[</span><span class="n">gas_num</span><span class="p">]</span> <span class="o">=</span> <span class="n">spec_gas2</span>
            <span class="n">injection_gas_list</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">spec_gas2</span><span class="p">])</span>
            <span class="n">counter</span> <span class="o">=</span> <span class="n">counter</span> <span class="o">+</span> <span class="mi">1</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">liner</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">break</span>

        <span class="k">return</span> <span class="n">initial_gas_list</span><span class="p">,</span> <span class="n">injection_gas_list</span><span class="p">,</span> <span class="n">initial_gas_mapping</span><span class="p">,</span> <span class="n">injection_gas_mapping</span></div>

<div class="viewcode-block" id="SynergyChemical.get_param_values_perm_poro"><a class="viewcode-back" href="../../../pytoughreact.writers.html#pytoughreact.writers.chemical_writing.SynergyChemical.get_param_values_perm_poro">[docs]</a>    <span class="k">def</span> <span class="nf">get_param_values_perm_poro</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">minerals</span><span class="p">,</span> <span class="n">grid</span><span class="p">):</span>
        <span class="n">initial_perm_poro_mapping</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">initial_perm_poro_list</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">line</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">file</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span>
        <span class="n">liner</span> <span class="o">=</span> <span class="p">(</span><span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">())</span>
        <span class="n">number_of_perm_poro_zones</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">liner</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">line</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">file</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span>
        <span class="n">liner</span> <span class="o">=</span> <span class="p">(</span><span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">())</span>
        <span class="n">counter</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">liner</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">MissingParameter</span>
        <span class="k">while</span> <span class="nb">int</span><span class="p">(</span><span class="n">liner</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">&lt;</span> <span class="n">number_of_perm_poro_zones</span> <span class="o">+</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">counter</span> <span class="o">&lt;</span> <span class="n">number_of_perm_poro_zones</span> <span class="o">+</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">perm_poro_num</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">liner</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="n">line</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">file</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span>
            <span class="n">line</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">file</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span>
            <span class="n">all_comp</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">while</span> <span class="n">line</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;&#39;*&quot;</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
                <span class="n">liner</span> <span class="o">=</span> <span class="p">(</span><span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">())</span>
                <span class="n">initial_perm_poro_value</span> <span class="o">=</span> <span class="n">liner</span>
                <span class="n">liner</span> <span class="o">=</span> <span class="p">(</span><span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">())</span>
                <span class="n">spec_perm_poro</span> <span class="o">=</span> <span class="n">PermPoro</span><span class="p">(</span><span class="n">initial_perm_poro_value</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">initial_perm_poro_value</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">initial_perm_poro_value</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
                <span class="n">spec_perm_poro_zone</span> <span class="o">=</span> <span class="n">PermPoroZone</span><span class="p">([</span><span class="n">spec_perm_poro</span><span class="p">])</span>
                <span class="n">all_comp</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">spec_perm_poro_zone</span><span class="p">)</span>
                <span class="n">initial_perm_poro_mapping</span><span class="p">[</span><span class="n">perm_poro_num</span><span class="p">]</span> <span class="o">=</span> <span class="n">PermPoroZone</span><span class="p">(</span><span class="n">all_comp</span><span class="p">)</span>
                <span class="n">initial_perm_poro_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">PermPoroZone</span><span class="p">(</span><span class="n">all_comp</span><span class="p">))</span>
                <span class="n">line</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">file</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span>
            <span class="n">line</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">file</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span>
            <span class="n">liner</span> <span class="o">=</span> <span class="p">(</span><span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">())</span>
            <span class="c1"># grid.zonelist[perm_poro_num -1].permporo = all_comp</span>
            <span class="n">counter</span> <span class="o">=</span> <span class="n">counter</span> <span class="o">+</span> <span class="mi">1</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">liner</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">break</span>

        <span class="k">return</span> <span class="n">initial_perm_poro_list</span><span class="p">,</span> <span class="n">initial_perm_poro_mapping</span></div></div>


<div class="viewcode-block" id="t2chemical"><a class="viewcode-back" href="../../../pytoughreact.writers.html#pytoughreact.writers.chemical_writing.t2chemical">[docs]</a><span class="k">class</span> <span class="nc">t2chemical</span><span class="p">(</span><span class="n">t2data</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Main class for structuring the writing , reading  of chemical parameters</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">meshfilename</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">t2reactgrid</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">path</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">read_function</span><span class="o">=</span><span class="n">default_read_function</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">t2grid</span> <span class="o">=</span> <span class="n">t2reactgrid</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_sections</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">title</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">primary_aqueous</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">aqueous_kinetics</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">aqueous_complexes</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">minerals</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">surface_complexes</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">decay_species</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">exchangeable_cations</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="c1"># self.gases = self.ij_gas</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">surface_adsorption</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">linear_equilibrium</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cation_exchange</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="c1"># self.waters = self.ib_waters</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">end_keyword</span> <span class="o">=</span> <span class="s1">&#39;#end&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">read_function</span> <span class="o">=</span> <span class="n">read_function</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ib_waters</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getib_waters</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">waters</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ib_waters</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ij_gas</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getij_gas</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gases</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ij_gas</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">meshfilename</span><span class="p">,</span> <span class="n">read_function</span><span class="p">)</span>

<div class="viewcode-block" id="t2chemical.getib_waters"><a class="viewcode-back" href="../../../pytoughreact.writers.html#pytoughreact.writers.chemical_writing.t2chemical.getib_waters">[docs]</a>    <span class="k">def</span> <span class="nf">getib_waters</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Get initial and boundary waters &quot;&quot;&quot;</span>
        <span class="n">ib_waters</span> <span class="o">=</span> <span class="p">[[],</span> <span class="p">[]]</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">t2grid</span><span class="o">.</span><span class="n">zonelist</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">ib_waters</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">t2grid</span><span class="o">.</span><span class="n">zonelist</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">gas</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">ib_waters</span>
        <span class="k">for</span> <span class="n">zone</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">t2grid</span><span class="o">.</span><span class="n">zonelist</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">zone</span><span class="o">.</span><span class="n">water</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
                <span class="k">if</span> <span class="n">zone</span><span class="o">.</span><span class="n">water</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">ib_waters</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
                    <span class="n">ib_waters</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">zone</span><span class="o">.</span><span class="n">water</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
            <span class="k">if</span> <span class="n">zone</span><span class="o">.</span><span class="n">water</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
                <span class="k">if</span> <span class="n">zone</span><span class="o">.</span><span class="n">water</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">ib_waters</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
                    <span class="n">ib_waters</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">zone</span><span class="o">.</span><span class="n">water</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
        <span class="k">return</span> <span class="n">ib_waters</span></div>

    <span class="c1"># ib_waters = property(getib_waters)</span>

<div class="viewcode-block" id="t2chemical.getij_gas"><a class="viewcode-back" href="../../../pytoughreact.writers.html#pytoughreact.writers.chemical_writing.t2chemical.getij_gas">[docs]</a>    <span class="k">def</span> <span class="nf">getij_gas</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Get initial and injection gas &quot;&quot;&quot;</span>
        <span class="n">ij_gas</span> <span class="o">=</span> <span class="p">[[],</span> <span class="p">[]]</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">t2grid</span><span class="o">.</span><span class="n">zonelist</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">ij_gas</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">t2grid</span><span class="o">.</span><span class="n">zonelist</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">gas</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">ij_gas</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">zone</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">t2grid</span><span class="o">.</span><span class="n">zonelist</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">zone</span><span class="o">.</span><span class="n">gas</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
                    <span class="k">if</span> <span class="n">zone</span><span class="o">.</span><span class="n">gas</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">ij_gas</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
                        <span class="n">ij_gas</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">zone</span><span class="o">.</span><span class="n">gas</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
                <span class="k">if</span> <span class="n">zone</span><span class="o">.</span><span class="n">gas</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
                    <span class="k">if</span> <span class="n">zone</span><span class="o">.</span><span class="n">gas</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">ij_gas</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
                        <span class="n">ij_gas</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">zone</span><span class="o">.</span><span class="n">gas</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
        <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
            <span class="k">pass</span>
        <span class="k">return</span> <span class="n">ij_gas</span></div>

    <span class="c1"># ij_gas = property(getij_gas)</span>

<div class="viewcode-block" id="t2chemical.get_mineral_zones"><a class="viewcode-back" href="../../../pytoughreact.writers.html#pytoughreact.writers.chemical_writing.t2chemical.get_mineral_zones">[docs]</a>    <span class="k">def</span> <span class="nf">get_mineral_zones</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Get Mineral zones&quot;&quot;&quot;</span>
        <span class="n">mineral_zone</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">zone</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">t2grid</span><span class="o">.</span><span class="n">zonelist</span><span class="p">:</span>
            <span class="n">mineral_zone</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">zone</span><span class="o">.</span><span class="n">mineral_zone</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">mineral_zone</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">mineral_zone</span><span class="p">)):</span>
            <span class="n">mineral_zone</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">mineral_zone</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">mineral_zone</span></div>

    <span class="n">mineral_zones</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">get_mineral_zones</span><span class="p">)</span>

<div class="viewcode-block" id="t2chemical.get_perm_poro_zones"><a class="viewcode-back" href="../../../pytoughreact.writers.html#pytoughreact.writers.chemical_writing.t2chemical.get_perm_poro_zones">[docs]</a>    <span class="k">def</span> <span class="nf">get_perm_poro_zones</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Get Porosity / Permeability zones&quot;&quot;&quot;</span>
        <span class="n">perm_poro_zone</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">zone</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">t2grid</span><span class="o">.</span><span class="n">zonelist</span><span class="p">:</span>
            <span class="n">perm_poro_zone</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">zone</span><span class="o">.</span><span class="n">permporo</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">perm_poro_zone</span></div>

    <span class="n">perm_poro</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">get_perm_poro_zones</span><span class="p">)</span>

<div class="viewcode-block" id="t2chemical.map_mineral_to_zone"><a class="viewcode-back" href="../../../pytoughreact.writers.html#pytoughreact.writers.chemical_writing.t2chemical.map_mineral_to_zone">[docs]</a>    <span class="k">def</span> <span class="nf">map_mineral_to_zone</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Map Mineral to Zone&quot;&quot;&quot;</span>
        <span class="n">zoning</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">index</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">for</span> <span class="n">zone</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">t2grid</span><span class="o">.</span><span class="n">zonelist</span><span class="p">:</span>
            <span class="n">zoning</span><span class="p">[</span><span class="n">index</span><span class="p">]</span> <span class="o">=</span> <span class="n">zone</span><span class="o">.</span><span class="n">mineral</span>
            <span class="n">index</span> <span class="o">=</span> <span class="n">index</span> <span class="o">+</span> <span class="mi">1</span>
        <span class="k">return</span> <span class="n">zoning</span></div>

<div class="viewcode-block" id="t2chemical.update_read_write_functions"><a class="viewcode-back" href="../../../pytoughreact.writers.html#pytoughreact.writers.chemical_writing.t2chemical.update_read_write_functions">[docs]</a>    <span class="k">def</span> <span class="nf">update_read_write_functions</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Updates functions for reading and writing sections of data file.&quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">read_fn</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span>
            <span class="n">t2chemical_sections</span><span class="p">,</span>
            <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">read_title</span><span class="p">,</span>
             <span class="bp">self</span><span class="o">.</span><span class="n">read_primary_aqueous</span><span class="p">,</span>
             <span class="bp">self</span><span class="o">.</span><span class="n">read_aqueous_kinetics</span><span class="p">,</span>
             <span class="bp">self</span><span class="o">.</span><span class="n">read_aqueous_complexes</span><span class="p">,</span>
             <span class="bp">self</span><span class="o">.</span><span class="n">read_minerals</span><span class="p">,</span>
             <span class="bp">self</span><span class="o">.</span><span class="n">read_gases</span><span class="p">,</span>
             <span class="bp">self</span><span class="o">.</span><span class="n">read_surface_complexes</span><span class="p">,</span>
             <span class="bp">self</span><span class="o">.</span><span class="n">read_decay_species</span><span class="p">,</span>
             <span class="bp">self</span><span class="o">.</span><span class="n">read_exchangeable_cations</span><span class="p">,</span>
             <span class="bp">self</span><span class="o">.</span><span class="n">read_ib_waters</span><span class="p">,</span>
             <span class="bp">self</span><span class="o">.</span><span class="n">read_mineral_zones</span><span class="p">,</span>
             <span class="bp">self</span><span class="o">.</span><span class="n">read_ij_gas</span><span class="p">,</span>
             <span class="bp">self</span><span class="o">.</span><span class="n">read_perm_poro</span><span class="p">,</span>
             <span class="bp">self</span><span class="o">.</span><span class="n">read_surface_adsorption</span><span class="p">,</span>
             <span class="bp">self</span><span class="o">.</span><span class="n">read_linear_equilibrium</span><span class="p">,</span>
             <span class="bp">self</span><span class="o">.</span><span class="n">read_cation_exchange</span><span class="p">]))</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">write_fn</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span>
            <span class="n">t2chemical_sections</span><span class="p">,</span>
            <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">write_title</span><span class="p">,</span>
             <span class="bp">self</span><span class="o">.</span><span class="n">write_primary_aqueous</span><span class="p">,</span>
             <span class="bp">self</span><span class="o">.</span><span class="n">write_aqueous_kinetics</span><span class="p">,</span>
             <span class="bp">self</span><span class="o">.</span><span class="n">write_aqueous_complexes</span><span class="p">,</span>
             <span class="bp">self</span><span class="o">.</span><span class="n">write_minerals</span><span class="p">,</span>
             <span class="bp">self</span><span class="o">.</span><span class="n">write_gases</span><span class="p">,</span>
             <span class="bp">self</span><span class="o">.</span><span class="n">write_surface_complexes</span><span class="p">,</span>
             <span class="bp">self</span><span class="o">.</span><span class="n">write_decay_species</span><span class="p">,</span>
             <span class="bp">self</span><span class="o">.</span><span class="n">write_exchangeable_cations</span><span class="p">,</span>
             <span class="bp">self</span><span class="o">.</span><span class="n">write_ib_waters</span><span class="p">,</span>
             <span class="bp">self</span><span class="o">.</span><span class="n">write_mineral_zones</span><span class="p">,</span>
             <span class="bp">self</span><span class="o">.</span><span class="n">write_ij_gas</span><span class="p">,</span>
             <span class="bp">self</span><span class="o">.</span><span class="n">write_perm_poro</span><span class="p">,</span>
             <span class="bp">self</span><span class="o">.</span><span class="n">write_surface_adsorption</span><span class="p">,</span>
             <span class="bp">self</span><span class="o">.</span><span class="n">write_linear_equilibrium</span><span class="p">,</span>
             <span class="bp">self</span><span class="o">.</span><span class="n">write_cation_exchange</span><span class="p">]))</span></div>

<div class="viewcode-block" id="t2chemical.get_present_sections"><a class="viewcode-back" href="../../../pytoughreact.writers.html#pytoughreact.writers.chemical_writing.t2chemical.get_present_sections">[docs]</a>    <span class="k">def</span> <span class="nf">get_present_sections</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns a list of TOUGH2 section keywords for which there are</span>
<span class="sd">        corresponding data in the t2bio object.&quot;&quot;&quot;</span>
        <span class="n">data_present</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span>
            <span class="n">t2chemical_sections</span><span class="p">,</span>
            <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">title</span><span class="p">,</span>
             <span class="bp">self</span><span class="o">.</span><span class="n">primary_aqueous</span><span class="p">,</span>
             <span class="bp">self</span><span class="o">.</span><span class="n">aqueous_kinetics</span><span class="p">,</span>
             <span class="bp">self</span><span class="o">.</span><span class="n">aqueous_complexes</span><span class="p">,</span>
             <span class="bp">self</span><span class="o">.</span><span class="n">minerals</span><span class="p">,</span>
             <span class="bp">self</span><span class="o">.</span><span class="n">gases</span><span class="p">,</span>
             <span class="bp">self</span><span class="o">.</span><span class="n">surface_complexes</span><span class="p">,</span>
             <span class="bp">self</span><span class="o">.</span><span class="n">decay_species</span><span class="p">,</span>
             <span class="bp">self</span><span class="o">.</span><span class="n">exchangeable_cations</span><span class="p">,</span>
             <span class="bp">self</span><span class="o">.</span><span class="n">ib_waters</span><span class="p">,</span>
             <span class="bp">self</span><span class="o">.</span><span class="n">mineral_zones</span><span class="p">,</span>
             <span class="bp">self</span><span class="o">.</span><span class="n">ij_gas</span><span class="p">,</span>
             <span class="bp">self</span><span class="o">.</span><span class="n">perm_poro</span><span class="p">,</span>
             <span class="bp">self</span><span class="o">.</span><span class="n">surface_adsorption</span><span class="p">,</span>
             <span class="bp">self</span><span class="o">.</span><span class="n">linear_equilibrium</span><span class="p">,</span>
             <span class="bp">self</span><span class="o">.</span><span class="n">cation_exchange</span><span class="p">]))</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">keyword</span> <span class="k">for</span> <span class="n">keyword</span> <span class="ow">in</span> <span class="n">t2chemical_sections</span> <span class="k">if</span> <span class="n">data_present</span><span class="p">[</span><span class="n">keyword</span><span class="p">]]</span></div>

    <span class="n">present_sections</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">get_present_sections</span><span class="p">)</span>

<div class="viewcode-block" id="t2chemical.section_insertion_index"><a class="viewcode-back" href="../../../pytoughreact.writers.html#pytoughreact.writers.chemical_writing.t2chemical.section_insertion_index">[docs]</a>    <span class="k">def</span> <span class="nf">section_insertion_index</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">section</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Determines an appropriate position to insert the specified section</span>
<span class="sd">        in the internal list of data file sections.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">listindex</span> <span class="o">=</span> <span class="n">t2chemical_sections</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">section</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">listindex</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">return</span> <span class="mi">0</span>  <span class="c1"># SIMUL section</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># first look for sections above the one specified,</span>
                <span class="c1"># and put new one just after the last found:</span>
                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">reversed</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">listindex</span><span class="p">)):</span>
                    <span class="k">try</span><span class="p">:</span>
                        <span class="n">section_index</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sections</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">t2chemical_sections</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                        <span class="k">return</span> <span class="n">section_index</span> <span class="o">+</span> <span class="mi">1</span>
                    <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
                        <span class="k">pass</span>
                <span class="c1"># look for sections below the one specified,</span>
                <span class="c1"># and put new one just before the first found:</span>
                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">listindex</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">t2chemical_sections</span><span class="p">)):</span>
                    <span class="k">try</span><span class="p">:</span>
                        <span class="n">section_index</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sections</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">t2chemical_sections</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                        <span class="k">return</span> <span class="n">section_index</span>
                    <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
                        <span class="k">pass</span>
                <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_sections</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_sections</span><span class="p">)</span></div>

<div class="viewcode-block" id="t2chemical.write_title"><a class="viewcode-back" href="../../../pytoughreact.writers.html#pytoughreact.writers.chemical_writing.t2chemical.write_title">[docs]</a>    <span class="k">def</span> <span class="nf">write_title</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">outfile</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Write Title od Chemical file (chemical.inp)&quot;&quot;&quot;</span>
        <span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;#Title&#39;</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">title</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span></div>

<div class="viewcode-block" id="t2chemical.read_primary_aqueous"><a class="viewcode-back" href="../../../pytoughreact.writers.html#pytoughreact.writers.chemical_writing.t2chemical.read_primary_aqueous">[docs]</a>    <span class="k">def</span> <span class="nf">read_primary_aqueous</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">infile</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Read Primary Aqueous Species &quot;&quot;&quot;</span>
        <span class="n">params</span> <span class="o">=</span> <span class="n">infile</span><span class="o">.</span><span class="n">get_param_values</span><span class="p">(</span><span class="s1">&#39;primary_aqueous&#39;</span><span class="p">)</span>
        <span class="n">all_species</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">parameter</span> <span class="ow">in</span> <span class="n">params</span><span class="p">:</span>
            <span class="n">all_species</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">PrimarySpecies</span><span class="p">(</span><span class="n">parameter</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">parameter</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
        <span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">[</span><span class="s1">&#39;primary_aqueous&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">all_species</span></div>

<div class="viewcode-block" id="t2chemical.write_primary_aqueous"><a class="viewcode-back" href="../../../pytoughreact.writers.html#pytoughreact.writers.chemical_writing.t2chemical.write_primary_aqueous">[docs]</a>    <span class="k">def</span> <span class="nf">write_primary_aqueous</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">outfile</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Write Primary Aqueous Species &quot;&quot;&quot;</span>
        <span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;#----------------------------------------------------------------------------</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;#DEFINITION OF THE GEOCHEMICAL SYSTEM</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;#PRIMARY AQUEOUS SPECIES</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">specie</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">primary_aqueous</span><span class="p">:</span>
            <span class="n">vals</span> <span class="o">=</span> <span class="n">specie</span><span class="o">.</span><span class="n">getNameTrans</span><span class="p">()</span>
            <span class="n">outfile</span><span class="o">.</span><span class="n">write_values</span><span class="p">(</span><span class="n">vals</span><span class="p">,</span> <span class="s1">&#39;primary_aqueous&#39;</span><span class="p">)</span>
        <span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;&#39;*&#39;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="t2chemical.read_aqueous_kinetics"><a class="viewcode-back" href="../../../pytoughreact.writers.html#pytoughreact.writers.chemical_writing.t2chemical.read_aqueous_kinetics">[docs]</a>    <span class="k">def</span> <span class="nf">read_aqueous_kinetics</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">infile</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Read Aqueous Kinetic Species &quot;&quot;&quot;</span>
        <span class="n">params</span> <span class="o">=</span> <span class="n">infile</span><span class="o">.</span><span class="n">get_param_values</span><span class="p">(</span><span class="s1">&#39;aqueous_kinetics&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">params</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">[</span><span class="s1">&#39;aqueous_kinetics&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">[</span><span class="s1">&#39;aqueous_kinetics&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">params</span></div>

<div class="viewcode-block" id="t2chemical.write_aqueous_kinetics"><a class="viewcode-back" href="../../../pytoughreact.writers.html#pytoughreact.writers.chemical_writing.t2chemical.write_aqueous_kinetics">[docs]</a>    <span class="k">def</span> <span class="nf">write_aqueous_kinetics</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">outfile</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Write Aqueous Kinetic Species &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">aqueous_kinetics</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
            <span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;# AQUEOUS KINETICS</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;&#39;*&#39;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">pass</span></div>

<div class="viewcode-block" id="t2chemical.read_aqueous_complexes"><a class="viewcode-back" href="../../../pytoughreact.writers.html#pytoughreact.writers.chemical_writing.t2chemical.read_aqueous_complexes">[docs]</a>    <span class="k">def</span> <span class="nf">read_aqueous_complexes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">infile</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Read Aqueous Complexes &quot;&quot;&quot;</span>
        <span class="n">params</span> <span class="o">=</span> <span class="n">infile</span><span class="o">.</span><span class="n">get_param_values</span><span class="p">(</span><span class="s1">&#39;aqueous_complex&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">params</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">[</span><span class="s1">&#39;aqueous_complexes&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">[</span><span class="s1">&#39;aqueous_complexes&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">params</span></div>

<div class="viewcode-block" id="t2chemical.write_aqueous_complexes"><a class="viewcode-back" href="../../../pytoughreact.writers.html#pytoughreact.writers.chemical_writing.t2chemical.write_aqueous_complexes">[docs]</a>    <span class="k">def</span> <span class="nf">write_aqueous_complexes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">outfile</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Write Aqueous Complexes &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">aqueous_complexes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
            <span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;# AQUEOUS COMPLEXES</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;&#39;*&#39;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="t2chemical.read_minerals"><a class="viewcode-back" href="../../../pytoughreact.writers.html#pytoughreact.writers.chemical_writing.t2chemical.read_minerals">[docs]</a>    <span class="k">def</span> <span class="nf">read_minerals</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">infile</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Read Minerals &quot;&quot;&quot;</span>
        <span class="n">params</span> <span class="o">=</span> <span class="n">infile</span><span class="o">.</span><span class="n">get_param_values_mineral</span><span class="p">()</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">params</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">[</span><span class="s1">&#39;minerals&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">[</span><span class="s1">&#39;minerals&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">params</span></div>

<div class="viewcode-block" id="t2chemical.write_dissolution_precipitation"><a class="viewcode-back" href="../../../pytoughreact.writers.html#pytoughreact.writers.chemical_writing.t2chemical.write_dissolution_precipitation">[docs]</a>    <span class="k">def</span> <span class="nf">write_dissolution_precipitation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">outfile</span><span class="p">,</span> <span class="n">mineral</span><span class="p">,</span> <span class="nb">format</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Write Dissolution and Precipitation Parameters &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">format</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;dissolution&#39;</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">vals</span> <span class="o">=</span> <span class="n">mineral</span><span class="o">.</span><span class="n">getDissolutionParams</span><span class="p">()</span>
            <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Dissolution parameters are not given&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">format</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;precipitation&#39;</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">vals</span> <span class="o">=</span> <span class="n">mineral</span><span class="o">.</span><span class="n">getPrecipitationParams</span><span class="p">()</span>
                <span class="n">vals2</span> <span class="o">=</span> <span class="n">mineral</span><span class="o">.</span><span class="n">getPrecipitationParams2</span><span class="p">()</span>
            <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Precipitation parameters are not given&quot;</span><span class="p">)</span>
        <span class="n">outfile</span><span class="o">.</span><span class="n">write_values</span><span class="p">(</span><span class="n">vals</span><span class="p">,</span> <span class="s1">&#39;minerals1.1&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">vals</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">vals</span> <span class="o">=</span> <span class="n">mineral</span><span class="o">.</span><span class="n">getpHDependency1</span><span class="p">()</span>
            <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;The dependency on pH has to be provided. See manual for more&quot;</span><span class="p">)</span>
            <span class="n">outfile</span><span class="o">.</span><span class="n">write_values</span><span class="p">(</span><span class="n">vals</span><span class="p">,</span> <span class="s1">&#39;minerals1.1.1&#39;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">vals</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
            <span class="n">vals1</span> <span class="o">=</span> <span class="n">mineral</span><span class="o">.</span><span class="n">getNumberOfpHDependence</span><span class="p">()</span>
            <span class="n">outfile</span><span class="o">.</span><span class="n">write_values</span><span class="p">(</span><span class="n">vals1</span><span class="p">,</span> <span class="s1">&#39;minerals1.1.2a&#39;</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">ph</span> <span class="ow">in</span> <span class="n">mineral</span><span class="o">.</span><span class="n">dissolution</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">pHDependence</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">vals</span> <span class="o">=</span> <span class="n">mineral</span><span class="o">.</span><span class="n">getpHDependency2</span><span class="p">(</span><span class="n">ph</span><span class="p">)</span>
                <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;The dependency on pH has to be provided. See manual for more&quot;</span><span class="p">)</span>
                <span class="n">outfile</span><span class="o">.</span><span class="n">write_values</span><span class="p">(</span><span class="n">vals</span><span class="p">,</span> <span class="s1">&#39;minerals1.1.2&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">format</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;precipitation&#39;</span><span class="p">:</span>
            <span class="n">outfile</span><span class="o">.</span><span class="n">write_values</span><span class="p">(</span><span class="n">vals2</span><span class="p">,</span> <span class="s1">&#39;minerals1.1.1a&#39;</span><span class="p">)</span></div>

<div class="viewcode-block" id="t2chemical.write_equilibrium"><a class="viewcode-back" href="../../../pytoughreact.writers.html#pytoughreact.writers.chemical_writing.t2chemical.write_equilibrium">[docs]</a>    <span class="k">def</span> <span class="nf">write_equilibrium</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">outfile</span><span class="p">,</span> <span class="n">mineral</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Write Equilibirum Parameters &quot;&quot;&quot;</span>
        <span class="n">vals</span> <span class="o">=</span> <span class="n">mineral</span><span class="o">.</span><span class="n">getEquilibriumData</span><span class="p">()</span>
        <span class="n">outfile</span><span class="o">.</span><span class="n">write_values</span><span class="p">(</span><span class="n">vals</span><span class="p">,</span> <span class="s1">&#39;minerals1.1.1a&#39;</span><span class="p">)</span></div>

<div class="viewcode-block" id="t2chemical.write_minerals"><a class="viewcode-back" href="../../../pytoughreact.writers.html#pytoughreact.writers.chemical_writing.t2chemical.write_minerals">[docs]</a>    <span class="k">def</span> <span class="nf">write_minerals</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">outfile</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Write Minerals to file &quot;&quot;&quot;</span>
        <span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;#MINERALS</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">mineral</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">minerals</span><span class="p">:</span>
            <span class="n">vals</span> <span class="o">=</span> <span class="n">mineral</span><span class="o">.</span><span class="n">getFirstRow</span><span class="p">()</span>
            <span class="n">outfile</span><span class="o">.</span><span class="n">write_values</span><span class="p">(</span><span class="n">vals</span><span class="p">,</span> <span class="s1">&#39;minerals&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">vals</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="p">(</span><span class="n">vals</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">or</span> <span class="n">vals</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="mi">3</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">write_dissolution_precipitation</span><span class="p">(</span><span class="n">outfile</span><span class="p">,</span> <span class="n">mineral</span><span class="p">,</span> <span class="s1">&#39;dissolution&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">vals</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="p">(</span><span class="n">vals</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="mi">2</span> <span class="ow">or</span> <span class="n">vals</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="mi">3</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">write_dissolution_precipitation</span><span class="p">(</span><span class="n">outfile</span><span class="p">,</span> <span class="n">mineral</span><span class="p">,</span> <span class="s1">&#39;precipitation&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">vals</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">write_equilibrium</span><span class="p">(</span><span class="n">outfile</span><span class="p">,</span> <span class="n">mineral</span><span class="p">)</span>
        <span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;&#39;*&#39;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="t2chemical.read_gases"><a class="viewcode-back" href="../../../pytoughreact.writers.html#pytoughreact.writers.chemical_writing.t2chemical.read_gases">[docs]</a>    <span class="k">def</span> <span class="nf">read_gases</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">infile</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Read gases from file &quot;&quot;&quot;</span>
        <span class="n">params</span> <span class="o">=</span> <span class="n">infile</span><span class="o">.</span><span class="n">get_param_values_gas</span><span class="p">()</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">params</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="c1"># self.__dict__[&#39;gas_init&#39;] = [-1]</span>
            <span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">[</span><span class="s1">&#39;gases&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># self.__dict__[&#39;gas_init&#39;] = params</span>
            <span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">[</span><span class="s1">&#39;gases&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">params</span></div>

<div class="viewcode-block" id="t2chemical.write_gases"><a class="viewcode-back" href="../../../pytoughreact.writers.html#pytoughreact.writers.chemical_writing.t2chemical.write_gases">[docs]</a>    <span class="k">def</span> <span class="nf">write_gases</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">outfile</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Write gases to file &quot;&quot;&quot;</span>
        <span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;# GASES</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">gas_name</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">gas</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">ij_gas</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]:</span>
                <span class="k">if</span> <span class="n">gas</span><span class="o">.</span><span class="n">name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">gas_name</span><span class="p">:</span>
                    <span class="n">vals</span> <span class="o">=</span> <span class="p">[</span><span class="n">gas</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">gas</span><span class="o">.</span><span class="n">fugacity_flag</span><span class="p">]</span>
                <span class="n">outfile</span><span class="o">.</span><span class="n">write_values</span><span class="p">(</span><span class="n">vals</span><span class="p">,</span> <span class="s1">&#39;gases&#39;</span><span class="p">)</span>
                <span class="n">gas_name</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">gas</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
            <span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;&#39;*&#39;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">gas</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">ij_gas</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
                <span class="k">if</span> <span class="n">gas</span><span class="o">.</span><span class="n">name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">gas_name</span><span class="p">:</span>
                    <span class="n">vals</span> <span class="o">=</span> <span class="p">[</span><span class="n">gas</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">gas</span><span class="o">.</span><span class="n">fugacity_flag</span><span class="p">]</span>
                <span class="n">outfile</span><span class="o">.</span><span class="n">write_values</span><span class="p">(</span><span class="n">vals</span><span class="p">,</span> <span class="s1">&#39;gases&#39;</span><span class="p">)</span>
                <span class="n">gas_name</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">gas</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
            <span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;&#39;*&#39;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="t2chemical.read_surface_complexes"><a class="viewcode-back" href="../../../pytoughreact.writers.html#pytoughreact.writers.chemical_writing.t2chemical.read_surface_complexes">[docs]</a>    <span class="k">def</span> <span class="nf">read_surface_complexes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">infile</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Read surface complexes from file &quot;&quot;&quot;</span>
        <span class="n">params</span> <span class="o">=</span> <span class="n">infile</span><span class="o">.</span><span class="n">get_param_values_surface_complex</span><span class="p">()</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">params</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">[</span><span class="s1">&#39;surface_complexes&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">[</span><span class="s1">&#39;surface_complexes&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">params</span></div>

<div class="viewcode-block" id="t2chemical.write_surface_complexes"><a class="viewcode-back" href="../../../pytoughreact.writers.html#pytoughreact.writers.chemical_writing.t2chemical.write_surface_complexes">[docs]</a>    <span class="k">def</span> <span class="nf">write_surface_complexes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">outfile</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Write surface complexes to file &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">surface_complexes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
            <span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;# SURFACE COMPLEXES</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;&#39;*&#39;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="t2chemical.read_decay_species"><a class="viewcode-back" href="../../../pytoughreact.writers.html#pytoughreact.writers.chemical_writing.t2chemical.read_decay_species">[docs]</a>    <span class="k">def</span> <span class="nf">read_decay_species</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">infile</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Read decay species from file &quot;&quot;&quot;</span>
        <span class="n">params</span> <span class="o">=</span> <span class="n">infile</span><span class="o">.</span><span class="n">get_param_values_decay_species</span><span class="p">()</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">params</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">[</span><span class="s1">&#39;decay_species&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">[</span><span class="s1">&#39;decay_species&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">params</span></div>

<div class="viewcode-block" id="t2chemical.write_decay_species"><a class="viewcode-back" href="../../../pytoughreact.writers.html#pytoughreact.writers.chemical_writing.t2chemical.write_decay_species">[docs]</a>    <span class="k">def</span> <span class="nf">write_decay_species</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">outfile</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Write decay species to file &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">decay_species</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
            <span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;# SPECIES WITH Kd AND DECAY</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;&#39;*&#39;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="t2chemical.read_exchangeable_cations"><a class="viewcode-back" href="../../../pytoughreact.writers.html#pytoughreact.writers.chemical_writing.t2chemical.read_exchangeable_cations">[docs]</a>    <span class="k">def</span> <span class="nf">read_exchangeable_cations</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">infile</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Read Exchangeable Cations from file &quot;&quot;&quot;</span>
        <span class="n">params</span> <span class="o">=</span> <span class="n">infile</span><span class="o">.</span><span class="n">get_param_values_exchangeable_cations</span><span class="p">()</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">params</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">[</span><span class="s1">&#39;exchangeable_cations&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">[</span><span class="s1">&#39;exchangeable_cations&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">params</span></div>

<div class="viewcode-block" id="t2chemical.write_exchangeable_cations"><a class="viewcode-back" href="../../../pytoughreact.writers.html#pytoughreact.writers.chemical_writing.t2chemical.write_exchangeable_cations">[docs]</a>    <span class="k">def</span> <span class="nf">write_exchangeable_cations</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">outfile</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Write Exchangeable Cations to file &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">exchangeable_cations</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
            <span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;# EXCHANGEABLE CATIONS</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;&#39;*&#39;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">pass</span></div>

<div class="viewcode-block" id="t2chemical.read_ib_waters"><a class="viewcode-back" href="../../../pytoughreact.writers.html#pytoughreact.writers.chemical_writing.t2chemical.read_ib_waters">[docs]</a>    <span class="k">def</span> <span class="nf">read_ib_waters</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">infile</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Read Initial and Boundary waters from file &quot;&quot;&quot;</span>
        <span class="n">initial_waters_list</span><span class="p">,</span> <span class="n">boundary_waters_list</span><span class="p">,</span> <span class="n">initial_waters_mapping</span><span class="p">,</span> <span class="n">boundary_waters_mapping</span> <span class="o">=</span> <span class="n">infile</span><span class="o">.</span><span class="n">get_param_values_ib_waters</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">primary_aqueous</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">t2grid</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">initial_waters_list</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">[</span><span class="s1">&#39;ib_waters&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">[</span><span class="s1">&#39;waters&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">initial_waters_list</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">boundary_waters_list</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">[</span><span class="s1">&#39;waters&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">boundary_waters_list</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">initial_waters_mapping</span> <span class="o">=</span> <span class="n">initial_waters_mapping</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">boundary_waters_mapping</span><span class="o">.</span><span class="n">keys</span><span class="p">()))</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">boundary_waters_mapping</span> <span class="o">=</span> <span class="n">boundary_waters_mapping</span></div>

<div class="viewcode-block" id="t2chemical.getInitialWaterRow"><a class="viewcode-back" href="../../../pytoughreact.writers.html#pytoughreact.writers.chemical_writing.t2chemical.getInitialWaterRow">[docs]</a>    <span class="k">def</span> <span class="nf">getInitialWaterRow</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">water</span><span class="p">):</span>
        <span class="k">pass</span></div>
        <span class="c1"># print(water[0][&#39;initial&#39;])</span>

<div class="viewcode-block" id="t2chemical.getInitialWatersTemperature"><a class="viewcode-back" href="../../../pytoughreact.writers.html#pytoughreact.writers.chemical_writing.t2chemical.getInitialWatersTemperature">[docs]</a>    <span class="k">def</span> <span class="nf">getInitialWatersTemperature</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">all_waters</span><span class="p">):</span>
        <span class="k">pass</span></div>
        <span class="c1"># print(all_waters[0][&#39;initial&#39;])</span>

<div class="viewcode-block" id="t2chemical.getInitialWatersPressure"><a class="viewcode-back" href="../../../pytoughreact.writers.html#pytoughreact.writers.chemical_writing.t2chemical.getInitialWatersPressure">[docs]</a>    <span class="k">def</span> <span class="nf">getInitialWatersPressure</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">all_waters</span><span class="p">):</span>
        <span class="k">pass</span></div>
        <span class="c1"># print(all_waters[0][&#39;initial&#39;])</span>

<div class="viewcode-block" id="t2chemical.getBoundaryWaters"><a class="viewcode-back" href="../../../pytoughreact.writers.html#pytoughreact.writers.chemical_writing.t2chemical.getBoundaryWaters">[docs]</a>    <span class="k">def</span> <span class="nf">getBoundaryWaters</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">all_waters</span><span class="p">):</span>
        <span class="k">pass</span></div>
        <span class="c1"># for i in range(len(all_waters)):</span>
        <span class="c1">#     print(all_waters[0][0][&#39;boundary&#39;])</span>

<div class="viewcode-block" id="t2chemical.write_ib_waters"><a class="viewcode-back" href="../../../pytoughreact.writers.html#pytoughreact.writers.chemical_writing.t2chemical.write_ib_waters">[docs]</a>    <span class="k">def</span> <span class="nf">write_ib_waters</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">outfile</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Write Initial and Boundary waters to file &quot;&quot;&quot;</span>
        <span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;#----------------------------------------------------------------------------</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;# # INITIAL AND BOUNDARY WATER TYPES</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">initial_waters</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ib_waters</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">vals</span> <span class="o">=</span> <span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ib_waters</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ib_waters</span><span class="p">[</span><span class="mi">1</span><span class="p">])]</span>
        <span class="n">outfile</span><span class="o">.</span><span class="n">write_values</span><span class="p">(</span><span class="n">vals</span><span class="p">,</span> <span class="s1">&#39;water_comp&#39;</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">initial_waters</span><span class="p">)):</span>
                <span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;# Index  Speciation T(C)  P(bar)  </span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
                <span class="n">vals</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">initial_waters</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">temperature</span><span class="p">,</span> <span class="n">initial_waters</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">pressure</span><span class="p">]</span>
                <span class="n">outfile</span><span class="o">.</span><span class="n">write_values</span><span class="p">(</span><span class="n">vals</span><span class="p">,</span> <span class="s1">&#39;water_comp1&#39;</span><span class="p">)</span>
                <span class="n">species</span> <span class="o">=</span> <span class="n">initial_waters</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">primary_species</span>
                <span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;#        icon       NRguess(molal)  ctot (molal)   </span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">specie</span> <span class="ow">in</span> <span class="n">species</span><span class="p">:</span>
                    <span class="n">vals</span> <span class="o">=</span> <span class="p">[</span><span class="n">specie</span><span class="o">.</span><span class="n">primary_species</span><span class="o">.</span><span class="n">NAME</span><span class="o">.</span><span class="n">strip</span><span class="p">(),</span> <span class="n">specie</span><span class="o">.</span><span class="n">icon</span><span class="p">,</span> <span class="n">specie</span><span class="o">.</span><span class="n">nrguess</span><span class="p">,</span> <span class="n">specie</span><span class="o">.</span><span class="n">ctot</span><span class="p">,</span> <span class="n">specie</span><span class="o">.</span><span class="n">nameq</span><span class="p">,</span>
                            <span class="n">specie</span><span class="o">.</span><span class="n">qksat</span><span class="p">]</span>
                    <span class="n">outfile</span><span class="o">.</span><span class="n">write_values</span><span class="p">(</span><span class="n">vals</span><span class="p">,</span> <span class="s1">&#39;water_comp2&#39;</span><span class="p">)</span>
                <span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;&#39;*&#39;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">initial_waters</span><span class="p">)):</span>
                <span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;# Index  Speciation T(C)  P(bar)  </span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
                <span class="n">vals</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">initial_waters</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">temperature</span><span class="p">,</span> <span class="n">initial_waters</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">pressure</span><span class="p">]</span>
                <span class="n">outfile</span><span class="o">.</span><span class="n">write_values</span><span class="p">(</span><span class="n">vals</span><span class="p">,</span> <span class="s1">&#39;water_comp1&#39;</span><span class="p">)</span>
                <span class="n">species</span> <span class="o">=</span> <span class="n">initial_waters</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">primary_species</span>
                <span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;#        icon       NRguess(molal)  ctot (molal)   </span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">specie</span> <span class="ow">in</span> <span class="n">species</span><span class="p">:</span>
                    <span class="n">vals</span> <span class="o">=</span> <span class="p">[</span><span class="n">specie</span><span class="o">.</span><span class="n">primary_species</span><span class="o">.</span><span class="n">NAME</span><span class="o">.</span><span class="n">strip</span><span class="p">(),</span> <span class="n">specie</span><span class="o">.</span><span class="n">icon</span><span class="p">,</span> <span class="n">specie</span><span class="o">.</span><span class="n">nrguess</span><span class="p">,</span> <span class="n">specie</span><span class="o">.</span><span class="n">ctot</span><span class="p">,</span> <span class="n">specie</span><span class="o">.</span><span class="n">nameq</span><span class="p">,</span>
                            <span class="n">specie</span><span class="o">.</span><span class="n">qksat</span><span class="p">]</span>
                    <span class="n">outfile</span><span class="o">.</span><span class="n">write_values</span><span class="p">(</span><span class="n">vals</span><span class="p">,</span> <span class="s1">&#39;water_comp2&#39;</span><span class="p">)</span>
                <span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;&#39;*&#39;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="n">boundary_water</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ib_waters</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">boundary_water</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">boundary_water</span><span class="p">)):</span>
                    <span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;# Index  Speciation T(C)  P(bar)  </span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
                    <span class="n">vals</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">boundary_water</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">temperature</span><span class="p">,</span> <span class="n">boundary_water</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">pressure</span><span class="p">]</span>
                    <span class="n">outfile</span><span class="o">.</span><span class="n">write_values</span><span class="p">(</span><span class="n">vals</span><span class="p">,</span> <span class="s1">&#39;water_comp1&#39;</span><span class="p">)</span>
                    <span class="n">species</span> <span class="o">=</span> <span class="n">boundary_water</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">primary_species</span>
                    <span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;#        icon       NRguess(molal)  ctot (molal)   </span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
                    <span class="k">for</span> <span class="n">specie</span> <span class="ow">in</span> <span class="n">species</span><span class="p">:</span>
                        <span class="n">vals</span> <span class="o">=</span> <span class="p">[</span><span class="n">specie</span><span class="o">.</span><span class="n">primary_species</span><span class="o">.</span><span class="n">NAME</span><span class="o">.</span><span class="n">strip</span><span class="p">(),</span> <span class="n">specie</span><span class="o">.</span><span class="n">icon</span><span class="p">,</span> <span class="n">specie</span><span class="o">.</span><span class="n">nrguess</span><span class="p">,</span> <span class="n">specie</span><span class="o">.</span><span class="n">ctot</span><span class="p">,</span> <span class="n">specie</span><span class="o">.</span><span class="n">nameq</span><span class="p">,</span>
                                <span class="n">specie</span><span class="o">.</span><span class="n">qksat</span><span class="p">]</span>
                        <span class="n">outfile</span><span class="o">.</span><span class="n">write_values</span><span class="p">(</span><span class="n">vals</span><span class="p">,</span> <span class="s1">&#39;water_comp2&#39;</span><span class="p">)</span>
                    <span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;&#39;*&#39;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">boundary_water</span><span class="p">)):</span>
                    <span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;# Index  Speciation T(C)  P(bar)  </span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
                    <span class="n">vals</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">boundary_water</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">temperature</span><span class="p">,</span> <span class="n">boundary_water</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">pressure</span><span class="p">]</span>
                    <span class="n">outfile</span><span class="o">.</span><span class="n">write_values</span><span class="p">(</span><span class="n">vals</span><span class="p">,</span> <span class="s1">&#39;water_comp1&#39;</span><span class="p">)</span>
                    <span class="n">species</span> <span class="o">=</span> <span class="n">boundary_water</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">primary_species</span>
                    <span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;#        icon       NRguess(molal)  ctot (molal)   </span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
                    <span class="k">for</span> <span class="n">specie</span> <span class="ow">in</span> <span class="n">species</span><span class="p">:</span>
                        <span class="n">vals</span> <span class="o">=</span> <span class="p">[</span><span class="n">specie</span><span class="o">.</span><span class="n">primary_species</span><span class="o">.</span><span class="n">NAME</span><span class="o">.</span><span class="n">strip</span><span class="p">(),</span> <span class="n">specie</span><span class="o">.</span><span class="n">icon</span><span class="p">,</span> <span class="n">specie</span><span class="o">.</span><span class="n">nrguess</span><span class="p">,</span> <span class="n">specie</span><span class="o">.</span><span class="n">ctot</span><span class="p">,</span> <span class="n">specie</span><span class="o">.</span><span class="n">nameq</span><span class="p">,</span>
                                <span class="n">specie</span><span class="o">.</span><span class="n">qksat</span><span class="p">]</span>
                        <span class="n">outfile</span><span class="o">.</span><span class="n">write_values</span><span class="p">(</span><span class="n">vals</span><span class="p">,</span> <span class="s1">&#39;water_comp2&#39;</span><span class="p">)</span>
                    <span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;&#39;*&#39;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="t2chemical.getInitialWaterIndex"><a class="viewcode-back" href="../../../pytoughreact.writers.html#pytoughreact.writers.chemical_writing.t2chemical.getInitialWaterIndex">[docs]</a>    <span class="k">def</span> <span class="nf">getInitialWaterIndex</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Get Initial Water Index &quot;&quot;&quot;</span>
        <span class="n">water_index</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">initial_waters</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ib_waters</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">initial_waters</span><span class="p">)):</span>
            <span class="n">water_index</span><span class="p">[</span><span class="n">initial_waters</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]]</span> <span class="o">=</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span>

        <span class="k">return</span> <span class="n">water_index</span></div>

    <span class="n">initial_water_index</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">getInitialWaterIndex</span><span class="p">)</span>

<div class="viewcode-block" id="t2chemical.getBoundaryWaterIndex"><a class="viewcode-back" href="../../../pytoughreact.writers.html#pytoughreact.writers.chemical_writing.t2chemical.getBoundaryWaterIndex">[docs]</a>    <span class="k">def</span> <span class="nf">getBoundaryWaterIndex</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Get Boundary Water Index &quot;&quot;&quot;</span>
        <span class="n">water_index</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">boundary_water</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ib_waters</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">boundary_water</span><span class="p">)):</span>
            <span class="n">water_index</span><span class="p">[</span><span class="n">boundary_water</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]]</span> <span class="o">=</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span>

        <span class="k">return</span> <span class="n">water_index</span></div>

    <span class="n">boundary_water_index</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">getBoundaryWaterIndex</span><span class="p">)</span>

<div class="viewcode-block" id="t2chemical.getMineralIndex"><a class="viewcode-back" href="../../../pytoughreact.writers.html#pytoughreact.writers.chemical_writing.t2chemical.getMineralIndex">[docs]</a>    <span class="k">def</span> <span class="nf">getMineralIndex</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Get Mineral Index &quot;&quot;&quot;</span>
        <span class="n">mineral_index</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">all_mineral</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mineral_zones</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">all_mineral</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">all_mineral</span><span class="p">)):</span>
            <span class="n">all_mineral</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">all_mineral</span><span class="p">))</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">all_mineral</span><span class="p">)):</span>
            <span class="n">mineral_index</span><span class="p">[</span><span class="n">all_mineral</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span> <span class="o">=</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span>
        <span class="k">return</span> <span class="n">mineral_index</span></div>

    <span class="n">mineral_index</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">getMineralIndex</span><span class="p">)</span>

<div class="viewcode-block" id="t2chemical.getInitialGasIndex"><a class="viewcode-back" href="../../../pytoughreact.writers.html#pytoughreact.writers.chemical_writing.t2chemical.getInitialGasIndex">[docs]</a>    <span class="k">def</span> <span class="nf">getInitialGasIndex</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Get Initial Gas Index &quot;&quot;&quot;</span>
        <span class="n">gas_index</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">initial_gas</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ij_gas</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">initial_gas</span><span class="p">)):</span>
            <span class="n">gas_index</span><span class="p">[</span><span class="n">initial_gas</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]]</span> <span class="o">=</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span>
        <span class="k">return</span> <span class="n">gas_index</span></div>

    <span class="n">initial_gas_index</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">getInitialGasIndex</span><span class="p">)</span>

<div class="viewcode-block" id="t2chemical.getInjectionGasIndex"><a class="viewcode-back" href="../../../pytoughreact.writers.html#pytoughreact.writers.chemical_writing.t2chemical.getInjectionGasIndex">[docs]</a>    <span class="k">def</span> <span class="nf">getInjectionGasIndex</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Get Injection Gas Index &quot;&quot;&quot;</span>
        <span class="n">gas_index</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">initial_gas</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ij_gas</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">initial_gas</span><span class="p">)):</span>
            <span class="n">gas_index</span><span class="p">[</span><span class="n">initial_gas</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]]</span> <span class="o">=</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span>
        <span class="k">return</span> <span class="n">gas_index</span></div>

    <span class="n">injection_gas_index</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">getInjectionGasIndex</span><span class="p">)</span>

<div class="viewcode-block" id="t2chemical.getPermPoroIndex"><a class="viewcode-back" href="../../../pytoughreact.writers.html#pytoughreact.writers.chemical_writing.t2chemical.getPermPoroIndex">[docs]</a>    <span class="k">def</span> <span class="nf">getPermPoroIndex</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Get Permeability Porosity Index&quot;&quot;&quot;</span>
        <span class="n">perm_poro_index</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">perm_poro</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">perm_poro</span>
        <span class="n">perm_poro_all</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">perm_poro</span><span class="p">)):</span>
            <span class="k">if</span> <span class="n">perm_poro</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">perm_poro_all</span><span class="p">:</span>
                <span class="n">perm_poro_index</span><span class="p">[</span><span class="n">perm_poro</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span> <span class="o">=</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span>
                <span class="n">perm_poro_all</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">perm_poro</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
        <span class="k">return</span> <span class="n">perm_poro_index</span></div>

    <span class="n">perm_poro_index</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">getPermPoroIndex</span><span class="p">)</span>

<div class="viewcode-block" id="t2chemical.read_mineral_zones"><a class="viewcode-back" href="../../../pytoughreact.writers.html#pytoughreact.writers.chemical_writing.t2chemical.read_mineral_zones">[docs]</a>    <span class="k">def</span> <span class="nf">read_mineral_zones</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">infile</span><span class="p">):</span>
        <span class="s2">&quot; Read Mineral Zones &quot;</span>
        <span class="n">initial_minerals_list</span><span class="p">,</span> <span class="n">initial_minerals_mapping</span> <span class="o">=</span> <span class="n">infile</span><span class="o">.</span><span class="n">get_param_values_mineral_zones</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">minerals</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">initial_minerals_list</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">[</span><span class="s1">&#39;mineral_zones&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">[</span><span class="s1">&#39;mineral_zones&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">initial_minerals_list</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">initial_minerals_mapping</span> <span class="o">=</span> <span class="n">initial_minerals_mapping</span></div>

<div class="viewcode-block" id="t2chemical.countZones"><a class="viewcode-back" href="../../../pytoughreact.writers.html#pytoughreact.writers.chemical_writing.t2chemical.countZones">[docs]</a>    <span class="k">def</span> <span class="nf">countZones</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="s2">&quot; Count number of zones&quot;</span>
        <span class="n">count</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mineral_zones</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">count</span></div>

<div class="viewcode-block" id="t2chemical.countMineralZones"><a class="viewcode-back" href="../../../pytoughreact.writers.html#pytoughreact.writers.chemical_writing.t2chemical.countMineralZones">[docs]</a>    <span class="k">def</span> <span class="nf">countMineralZones</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="s2">&quot; Count number of mineral zones&quot;</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mineral_zones</span><span class="p">))</span></div>

<div class="viewcode-block" id="t2chemical.write_mineral_zones"><a class="viewcode-back" href="../../../pytoughreact.writers.html#pytoughreact.writers.chemical_writing.t2chemical.write_mineral_zones">[docs]</a>    <span class="k">def</span> <span class="nf">write_mineral_zones</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">outfile</span><span class="p">):</span>
        <span class="s2">&quot; Write mineral zones&quot;</span>
        <span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;#----------------------------------------------------------------------------</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;# INITIAL MINERAL ZONES</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">vals</span> <span class="o">=</span> <span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mineral_zones</span><span class="p">)]</span>
        <span class="c1"># masa = self.countMineralZones()</span>
        <span class="n">outfile</span><span class="o">.</span><span class="n">write_values</span><span class="p">(</span><span class="n">vals</span><span class="p">,</span> <span class="s1">&#39;mineral_zone&#39;</span><span class="p">)</span>
        <span class="n">index</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">for</span> <span class="n">zone</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">mineral_zones</span><span class="p">:</span>
            <span class="n">indexer</span> <span class="o">=</span> <span class="p">[</span><span class="n">index</span><span class="p">]</span>
            <span class="n">outfile</span><span class="o">.</span><span class="n">write_values</span><span class="p">(</span><span class="n">indexer</span><span class="p">,</span> <span class="s1">&#39;mineral_zone1&#39;</span><span class="p">)</span>
            <span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;# mineral         vol.frac</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">mineralcomp</span> <span class="ow">in</span> <span class="n">zone</span><span class="o">.</span><span class="n">minerals</span><span class="p">:</span>
                <span class="n">vals</span> <span class="o">=</span> <span class="p">[</span><span class="n">mineralcomp</span><span class="o">.</span><span class="n">mineral</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">mineralcomp</span><span class="o">.</span><span class="n">init_volume_fraction</span><span class="p">,</span> <span class="n">mineralcomp</span><span class="o">.</span><span class="n">reaction_type</span><span class="p">]</span>
                <span class="n">outfile</span><span class="o">.</span><span class="n">write_values</span><span class="p">(</span><span class="n">vals</span><span class="p">,</span> <span class="s1">&#39;mineral_zone2&#39;</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">mineralcomp</span><span class="o">.</span><span class="n">radius</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">mineralcomp</span><span class="o">.</span><span class="n">reactive_surface_area</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">mineralcomp</span><span class="o">.</span><span class="n">unit</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">vals</span> <span class="o">=</span> <span class="p">[</span><span class="n">mineralcomp</span><span class="o">.</span><span class="n">radius</span><span class="p">,</span> <span class="n">mineralcomp</span><span class="o">.</span><span class="n">reactive_surface_area</span><span class="p">,</span> <span class="n">mineralcomp</span><span class="o">.</span><span class="n">unit</span><span class="p">]</span>
                    <span class="n">outfile</span><span class="o">.</span><span class="n">write_values</span><span class="p">(</span><span class="n">vals</span><span class="p">,</span> <span class="s1">&#39;mineral_zone2.1&#39;</span><span class="p">)</span>
            <span class="n">index</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;&#39;*&#39;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="t2chemical.read_ij_gas"><a class="viewcode-back" href="../../../pytoughreact.writers.html#pytoughreact.writers.chemical_writing.t2chemical.read_ij_gas">[docs]</a>    <span class="k">def</span> <span class="nf">read_ij_gas</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">infile</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Read Initial and Injection Gas&quot;&quot;&quot;</span>
        <span class="n">initial_gas_list</span><span class="p">,</span> <span class="n">injection_gas_list</span><span class="p">,</span> <span class="n">initial_gas_mapping</span><span class="p">,</span> <span class="n">injection_gas_mapping</span> <span class="o">=</span> <span class="n">infile</span><span class="o">.</span><span class="n">get_param_values_ij_gases</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">gases</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">initial_gas_list</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">[</span><span class="s1">&#39;ij_gas&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[[],</span> <span class="p">[]]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">[</span><span class="s1">&#39;ij_gas&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">initial_gas_list</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">initial_gas_mapping</span> <span class="o">=</span> <span class="n">initial_gas_mapping</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">injection_gas_list</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">[</span><span class="s1">&#39;ij_gas&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">injection_gas_list</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">injection_gas_mapping</span><span class="o">.</span><span class="n">keys</span><span class="p">()))</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">injection_gas_mapping</span> <span class="o">=</span> <span class="n">injection_gas_mapping</span></div>

<div class="viewcode-block" id="t2chemical.write_ij_gas"><a class="viewcode-back" href="../../../pytoughreact.writers.html#pytoughreact.writers.chemical_writing.t2chemical.write_ij_gas">[docs]</a>    <span class="k">def</span> <span class="nf">write_ij_gas</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">outfile</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Write Initial and Injection Gas&quot;&quot;&quot;</span>
        <span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;#----------------------------------------------------------------------------</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;# INITIAL and Injection gas ZONES </span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">initial_gas</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ij_gas</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">vals</span> <span class="o">=</span> <span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ij_gas</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ij_gas</span><span class="p">[</span><span class="mi">1</span><span class="p">])]</span>
        <span class="n">outfile</span><span class="o">.</span><span class="n">write_values</span><span class="p">(</span><span class="n">vals</span><span class="p">,</span> <span class="s1">&#39;gas_zone&#39;</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">initial_gas</span><span class="p">)):</span>
                <span class="n">vals</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span>
                <span class="n">outfile</span><span class="o">.</span><span class="n">write_values</span><span class="p">(</span><span class="n">vals</span><span class="p">,</span> <span class="s1">&#39;gas_zone1&#39;</span><span class="p">)</span>
                <span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;#gas      partial pressure (bar) !if zero or blank, equil with solution   </span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
                <span class="n">vals</span> <span class="o">=</span> <span class="p">[</span><span class="n">initial_gas</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">initial_gas</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">partial_pressure</span><span class="p">]</span>
                <span class="n">outfile</span><span class="o">.</span><span class="n">write_values</span><span class="p">(</span><span class="n">vals</span><span class="p">,</span> <span class="s1">&#39;gas_zone2&#39;</span><span class="p">)</span>
            <span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;&#39;*&#39;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">initial_gas</span><span class="p">)):</span>
                <span class="n">vals</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span>
                <span class="n">outfile</span><span class="o">.</span><span class="n">write_values</span><span class="p">(</span><span class="n">vals</span><span class="p">,</span> <span class="s1">&#39;gas_zone1&#39;</span><span class="p">)</span>
                <span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;#gas      partial pressure (bar) !if zero or blank, equil with solution   </span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
                <span class="n">vals</span> <span class="o">=</span> <span class="p">[</span><span class="n">initial_gas</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">initial_gas</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">partial_pressure</span><span class="p">]</span>
                <span class="n">outfile</span><span class="o">.</span><span class="n">write_values</span><span class="p">(</span><span class="n">vals</span><span class="p">,</span> <span class="s1">&#39;gas_zone2&#39;</span><span class="p">)</span>
            <span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;&#39;*&#39;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">boundary_gas</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ij_gas</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">boundary_gas</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">boundary_gas</span><span class="p">)):</span>
                    <span class="n">vals</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span>
                    <span class="n">outfile</span><span class="o">.</span><span class="n">write_values</span><span class="p">(</span><span class="n">vals</span><span class="p">,</span> <span class="s1">&#39;gas_zone1&#39;</span><span class="p">)</span>
                    <span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;#gas      partial pressure (bar) !if zero or blank, equil with solution   </span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
                    <span class="n">vals</span> <span class="o">=</span> <span class="p">[</span><span class="n">boundary_gas</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">boundary_gas</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">partial_pressure</span><span class="p">]</span>
                    <span class="n">outfile</span><span class="o">.</span><span class="n">write_values</span><span class="p">(</span><span class="n">vals</span><span class="p">,</span> <span class="s1">&#39;gas_zone2&#39;</span><span class="p">)</span>
                <span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;&#39;*&#39;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">boundary_gas</span><span class="p">)):</span>
                    <span class="n">vals</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span>
                    <span class="n">outfile</span><span class="o">.</span><span class="n">write_values</span><span class="p">(</span><span class="n">vals</span><span class="p">,</span> <span class="s1">&#39;gas_zone1&#39;</span><span class="p">)</span>
                    <span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;#gas      partial pressure (bar) !if zero or blank, equil with solution   </span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
                    <span class="n">vals</span> <span class="o">=</span> <span class="p">[</span><span class="n">boundary_gas</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">boundary_gas</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">partial_pressure</span><span class="p">]</span>
                    <span class="n">outfile</span><span class="o">.</span><span class="n">write_values</span><span class="p">(</span><span class="n">vals</span><span class="p">,</span> <span class="s1">&#39;gas_zone2&#39;</span><span class="p">)</span>
                <span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;&#39;*&#39;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="t2chemical.read_perm_poro"><a class="viewcode-back" href="../../../pytoughreact.writers.html#pytoughreact.writers.chemical_writing.t2chemical.read_perm_poro">[docs]</a>    <span class="k">def</span> <span class="nf">read_perm_poro</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">infile</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Read Peremability and Porosity Regions&quot;&quot;&quot;</span>
        <span class="n">initial_perm_poro_list</span><span class="p">,</span> <span class="n">initial_perm_poro_mapping</span> <span class="o">=</span> <span class="n">infile</span><span class="o">.</span><span class="n">get_param_values_perm_poro</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">minerals</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">t2grid</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">initial_perm_poro_list</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">[</span><span class="s1">&#39;perm_poro&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">[</span><span class="s1">&#39;perm_poro&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">initial_perm_poro_list</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">initial_perm_poro_mapping</span> <span class="o">=</span> <span class="n">initial_perm_poro_mapping</span></div>

<div class="viewcode-block" id="t2chemical.write_perm_poro"><a class="viewcode-back" href="../../../pytoughreact.writers.html#pytoughreact.writers.chemical_writing.t2chemical.write_perm_poro">[docs]</a>    <span class="k">def</span> <span class="nf">write_perm_poro</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">outfile</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Write Peremability and Porosity Regions&quot;&quot;&quot;</span>
        <span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;#----------------------------------------------------------------------------</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;# Permeability-Porosity Zones</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">all_perm_zones</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">perm_poro</span><span class="p">)):</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">all_perm_zones</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">perm_poro</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">permporo</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
                <span class="k">pass</span>
        <span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">all_perm_zones</span><span class="p">)))</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">total_perm_poro</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">perm_poro</span><span class="p">)):</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">perm_poro</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">permporo</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">total_perm_poro</span><span class="p">:</span>
                    <span class="n">vals</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">perm_poro</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">permporo</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">law_type</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">perm_poro</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">permporo</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">a_param</span><span class="p">,</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">perm_poro</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">permporo</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">b_param</span><span class="p">]</span>
                    <span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
                    <span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;# Perm law  a-parameter  b-parameter</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
                    <span class="n">total_perm_poro</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">perm_poro</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">permporo</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
                    <span class="n">outfile</span><span class="o">.</span><span class="n">write_values</span><span class="p">(</span><span class="n">vals</span><span class="p">,</span> <span class="s1">&#39;perm_poro_zone&#39;</span><span class="p">)</span>
                    <span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;&#39;*&#39;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">all_perm_zones</span><span class="p">)):</span>
                <span class="k">if</span> <span class="n">all_perm_zones</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">permporo</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">total_perm_poro</span><span class="p">:</span>
                    <span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
                    <span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;# Perm law  a-parameter  b-parameter</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
                    <span class="n">vals</span> <span class="o">=</span> <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">all_perm_zones</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">permporo</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">law_type</span><span class="p">),</span> <span class="nb">float</span><span class="p">(</span><span class="n">all_perm_zones</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">permporo</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">a_param</span><span class="p">),</span>
                            <span class="nb">float</span><span class="p">(</span><span class="n">all_perm_zones</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">permporo</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">b_param</span><span class="p">)]</span>
                    <span class="n">total_perm_poro</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">all_perm_zones</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">permporo</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
                    <span class="n">outfile</span><span class="o">.</span><span class="n">write_values</span><span class="p">(</span><span class="n">vals</span><span class="p">,</span> <span class="s1">&#39;perm_poro_zone&#39;</span><span class="p">)</span>
                    <span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;&#39;*&#39;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="t2chemical.read_surface_adsorption"><a class="viewcode-back" href="../../../pytoughreact.writers.html#pytoughreact.writers.chemical_writing.t2chemical.read_surface_adsorption">[docs]</a>    <span class="k">def</span> <span class="nf">read_surface_adsorption</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">infile</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Read Surface adsorption &quot;&quot;&quot;</span>
        <span class="k">pass</span></div>

<div class="viewcode-block" id="t2chemical.write_surface_adsorption"><a class="viewcode-back" href="../../../pytoughreact.writers.html#pytoughreact.writers.chemical_writing.t2chemical.write_surface_adsorption">[docs]</a>    <span class="k">def</span> <span class="nf">write_surface_adsorption</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">outfile</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Write Surface adsorption &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">surface_adsorption</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
            <span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;# INITIAL SURFACE ADSORPTION ZONES</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;&#39;*&#39;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="t2chemical.read_linear_equilibrium"><a class="viewcode-back" href="../../../pytoughreact.writers.html#pytoughreact.writers.chemical_writing.t2chemical.read_linear_equilibrium">[docs]</a>    <span class="k">def</span> <span class="nf">read_linear_equilibrium</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">infile</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Read Linear Equilibrium &quot;&quot;&quot;</span>
        <span class="k">pass</span></div>

<div class="viewcode-block" id="t2chemical.write_linear_equilibrium"><a class="viewcode-back" href="../../../pytoughreact.writers.html#pytoughreact.writers.chemical_writing.t2chemical.write_linear_equilibrium">[docs]</a>    <span class="k">def</span> <span class="nf">write_linear_equilibrium</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">outfile</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Write Linear Equilibrium &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">linear_equilibrium</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
            <span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;# INITIAL LINEAR EQUILIBRIUM Kd ZONE</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;&#39;*&#39;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="t2chemical.read_cation_exchange"><a class="viewcode-back" href="../../../pytoughreact.writers.html#pytoughreact.writers.chemical_writing.t2chemical.read_cation_exchange">[docs]</a>    <span class="k">def</span> <span class="nf">read_cation_exchange</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">infile</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Read Cation Exchange &quot;&quot;&quot;</span>
        <span class="k">pass</span></div>

<div class="viewcode-block" id="t2chemical.write_cation_exchange"><a class="viewcode-back" href="../../../pytoughreact.writers.html#pytoughreact.writers.chemical_writing.t2chemical.write_cation_exchange">[docs]</a>    <span class="k">def</span> <span class="nf">write_cation_exchange</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">outfile</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Write Cation Exchange &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">cation_exchange</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
            <span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;# INITIAL ZONES OF CATION EXCHANGE</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;&#39;*&#39;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">pass</span></div>

<div class="viewcode-block" id="t2chemical.write"><a class="viewcode-back" href="../../../pytoughreact.writers.html#pytoughreact.writers.chemical_writing.t2chemical.write">[docs]</a>    <span class="k">def</span> <span class="nf">write</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">meshfilename</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">runlocation</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span>
              <span class="n">extra_precision</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">echo_extra_precision</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Write to file (chemical.inp)&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">runlocation</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">runlocation</span><span class="p">):</span>
                <span class="n">os</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">runlocation</span><span class="p">)</span>
            <span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">runlocation</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">filename</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span><span class="p">:</span>
            <span class="n">filename</span> <span class="o">=</span> <span class="s1">&#39;chemical.inp&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update_sections</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update_read_write_functions</span><span class="p">()</span>
        <span class="n">outfile</span> <span class="o">=</span> <span class="n">SynergyChemical</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">keyword</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sections</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">write_fn</span><span class="p">[</span><span class="n">keyword</span><span class="p">](</span><span class="n">outfile</span><span class="p">)</span>
            <span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">end_keyword</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">outfile</span><span class="o">.</span><span class="n">close</span><span class="p">()</span></div>

<div class="viewcode-block" id="t2chemical.convert_to_t2chemical"><a class="viewcode-back" href="../../../pytoughreact.writers.html#pytoughreact.writers.chemical_writing.t2chemical.convert_to_t2chemical">[docs]</a>    <span class="k">def</span> <span class="nf">convert_to_t2chemical</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">keyword</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Get corresponding t2chemical keywords &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="s1">&#39;primary&#39;</span> <span class="ow">in</span> <span class="n">keyword</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">and</span> <span class="s1">&#39;aqueous&#39;</span> <span class="ow">in</span> <span class="n">keyword</span><span class="o">.</span><span class="n">lower</span><span class="p">():</span>
            <span class="k">return</span> <span class="s1">&#39;PRIMARY_AQUEOUS&#39;</span>
        <span class="k">elif</span> <span class="s1">&#39;kinetics&#39;</span> <span class="ow">in</span> <span class="n">keyword</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">and</span> <span class="s1">&#39;aqueous&#39;</span> <span class="ow">in</span> <span class="n">keyword</span><span class="o">.</span><span class="n">lower</span><span class="p">():</span>
            <span class="k">return</span> <span class="s1">&#39;AQUEOUS_KINETICS&#39;</span>
        <span class="k">elif</span> <span class="s1">&#39;complexes&#39;</span> <span class="ow">in</span> <span class="n">keyword</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">and</span> <span class="s1">&#39;aqueous&#39;</span> <span class="ow">in</span> <span class="n">keyword</span><span class="o">.</span><span class="n">lower</span><span class="p">():</span>
            <span class="k">return</span> <span class="s1">&#39;AQUEOUS_COMPLEXES&#39;</span>
        <span class="k">elif</span> <span class="s1">&#39;minerals&#39;</span> <span class="ow">in</span> <span class="n">keyword</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">and</span> <span class="s1">&#39;zone&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">keyword</span><span class="o">.</span><span class="n">lower</span><span class="p">():</span>
            <span class="k">return</span> <span class="s1">&#39;MINERALS&#39;</span>
        <span class="k">elif</span> <span class="s1">&#39;gases&#39;</span> <span class="ow">in</span> <span class="n">keyword</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">and</span> <span class="s1">&#39;initial&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">keyword</span><span class="o">.</span><span class="n">lower</span><span class="p">():</span>
            <span class="k">return</span> <span class="s1">&#39;GASES&#39;</span>
        <span class="k">elif</span> <span class="s1">&#39;complexes&#39;</span> <span class="ow">in</span> <span class="n">keyword</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">and</span> <span class="s1">&#39;surface&#39;</span> <span class="ow">in</span> <span class="n">keyword</span><span class="o">.</span><span class="n">lower</span><span class="p">():</span>
            <span class="k">return</span> <span class="s1">&#39;SURFACE_COMPLEXES&#39;</span>
        <span class="k">elif</span> <span class="s1">&#39;decay&#39;</span> <span class="ow">in</span> <span class="n">keyword</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">and</span> <span class="s1">&#39;species&#39;</span> <span class="ow">in</span> <span class="n">keyword</span><span class="o">.</span><span class="n">lower</span><span class="p">():</span>
            <span class="k">return</span> <span class="s1">&#39;DECAY_SPECIES&#39;</span>
        <span class="k">elif</span> <span class="s1">&#39;exchangeable&#39;</span> <span class="ow">in</span> <span class="n">keyword</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">and</span> <span class="s1">&#39;cation&#39;</span> <span class="ow">in</span> <span class="n">keyword</span><span class="o">.</span><span class="n">lower</span><span class="p">():</span>
            <span class="k">return</span> <span class="s1">&#39;EXCHANGEABLE_CATIONS&#39;</span>
        <span class="k">elif</span> <span class="s1">&#39;initial&#39;</span> <span class="ow">in</span> <span class="n">keyword</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">and</span> <span class="s1">&#39;water&#39;</span> <span class="ow">in</span> <span class="n">keyword</span><span class="o">.</span><span class="n">lower</span><span class="p">():</span>
            <span class="k">return</span> <span class="s1">&#39;IB_WATERS&#39;</span>
        <span class="k">elif</span> <span class="s1">&#39;mineral&#39;</span> <span class="ow">in</span> <span class="n">keyword</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">and</span> <span class="s1">&#39;zones&#39;</span> <span class="ow">in</span> <span class="n">keyword</span><span class="o">.</span><span class="n">lower</span><span class="p">():</span>
            <span class="k">return</span> <span class="s1">&#39;MINERAL_ZONES&#39;</span>
        <span class="k">elif</span> <span class="s1">&#39;initial&#39;</span> <span class="ow">in</span> <span class="n">keyword</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">and</span> <span class="s1">&#39;gas&#39;</span> <span class="ow">in</span> <span class="n">keyword</span><span class="o">.</span><span class="n">lower</span><span class="p">():</span>
            <span class="k">return</span> <span class="s1">&#39;IJ_GAS&#39;</span>
        <span class="k">elif</span> <span class="s1">&#39;permeability&#39;</span> <span class="ow">in</span> <span class="n">keyword</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">and</span> <span class="s1">&#39;zone&#39;</span> <span class="ow">in</span> <span class="n">keyword</span><span class="o">.</span><span class="n">lower</span><span class="p">():</span>
            <span class="k">return</span> <span class="s1">&#39;PERM_PORO&#39;</span>
        <span class="k">elif</span> <span class="s1">&#39;adsorption&#39;</span> <span class="ow">in</span> <span class="n">keyword</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">and</span> <span class="s1">&#39;surface&#39;</span> <span class="ow">in</span> <span class="n">keyword</span><span class="o">.</span><span class="n">lower</span><span class="p">():</span>
            <span class="k">return</span> <span class="s1">&#39;SURFACE_ADSORPTION&#39;</span>
        <span class="k">elif</span> <span class="s1">&#39;linear&#39;</span> <span class="ow">in</span> <span class="n">keyword</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">and</span> <span class="s1">&#39;equilibrium&#39;</span> <span class="ow">in</span> <span class="n">keyword</span><span class="o">.</span><span class="n">lower</span><span class="p">():</span>
            <span class="k">return</span> <span class="s1">&#39;LINEAR_EQUILIBRIUM&#39;</span>
        <span class="k">elif</span> <span class="s1">&#39;cation&#39;</span> <span class="ow">in</span> <span class="n">keyword</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">and</span> <span class="s1">&#39;zone&#39;</span> <span class="ow">in</span> <span class="n">keyword</span><span class="o">.</span><span class="n">lower</span><span class="p">():</span>
            <span class="k">return</span> <span class="s1">&#39;CATION_EXCHANGE&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="s1">&#39;false&#39;</span></div>

<div class="viewcode-block" id="t2chemical.read"><a class="viewcode-back" href="../../../pytoughreact.writers.html#pytoughreact.writers.chemical_writing.t2chemical.read">[docs]</a>    <span class="k">def</span> <span class="nf">read</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">meshfilename</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">runlocation</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">extra_precision</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">echo_extra_precision</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Read from file &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">runlocation</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">runlocation</span><span class="p">):</span>
                <span class="n">os</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">runlocation</span><span class="p">)</span>
            <span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">runlocation</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">filename</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">filename</span> <span class="o">=</span> <span class="n">filename</span>
        <span class="n">mode</span> <span class="o">=</span> <span class="s1">&#39;r&#39;</span> <span class="k">if</span> <span class="n">sys</span><span class="o">.</span><span class="n">version_info</span> <span class="o">&gt;</span> <span class="p">(</span><span class="mi">3</span><span class="p">,)</span> <span class="k">else</span> <span class="s1">&#39;rU&#39;</span>
        <span class="n">infile</span> <span class="o">=</span> <span class="n">SynergyChemical</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="p">,</span> <span class="n">mode</span><span class="p">,</span> <span class="n">read_function</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">read_function</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">read_title</span><span class="p">(</span><span class="n">infile</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_sections</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update_read_write_functions</span><span class="p">()</span>
        <span class="n">more</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="n">next_line</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="c1"># countline = 0</span>
        <span class="k">while</span> <span class="n">more</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">next_line</span><span class="p">:</span>
                <span class="n">line</span> <span class="o">=</span> <span class="n">next_line</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">line</span> <span class="o">=</span> <span class="n">infile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">line</span><span class="p">:</span>
                <span class="c1"># keyword = line[0: 5].strip()</span>
                <span class="n">keyword</span> <span class="o">=</span> <span class="n">line</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
                <span class="n">check_presence</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">convert_to_t2chemical</span><span class="p">(</span><span class="n">keyword</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">keyword</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;ENDCY&#39;</span><span class="p">,</span> <span class="s1">&#39;ENDFI&#39;</span><span class="p">,</span> <span class="s1">&#39;end&#39;</span><span class="p">]:</span>
                    <span class="n">more</span> <span class="o">=</span> <span class="kc">False</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">end_keyword</span> <span class="o">=</span> <span class="n">keyword</span>
                <span class="c1"># elif keyword in t2chemical_read_sections:</span>
                <span class="c1"># elif any(ext in keyword for ext in t2chemical_read_sections):</span>
                <span class="k">elif</span> <span class="n">check_presence</span> <span class="o">!=</span> <span class="s1">&#39;false&#39;</span><span class="p">:</span>
                    <span class="n">keyword</span> <span class="o">=</span> <span class="n">check_presence</span>
                    <span class="n">fn</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">read_fn</span><span class="p">[</span><span class="n">keyword</span><span class="p">]</span>
                    <span class="n">next_line</span> <span class="o">=</span> <span class="kc">None</span>
                    <span class="k">if</span> <span class="n">keyword</span> <span class="o">==</span> <span class="s1">&#39;SHORT&#39;</span><span class="p">:</span>
                        <span class="n">fn</span><span class="p">(</span><span class="n">infile</span><span class="p">,</span> <span class="n">line</span><span class="p">)</span>
                    <span class="k">elif</span> <span class="n">keyword</span> <span class="o">==</span> <span class="s1">&#39;PARAM&#39;</span><span class="p">:</span>
                        <span class="n">next_line</span> <span class="o">=</span> <span class="n">fn</span><span class="p">(</span><span class="n">infile</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">fn</span><span class="p">(</span><span class="n">infile</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_sections</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">keyword</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">more</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">status</span> <span class="o">=</span> <span class="s1">&#39;successful&#39;</span>
        <span class="n">infile</span><span class="o">.</span><span class="n">close</span><span class="p">()</span></div></div>
</pre></div>

           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, Temitope Ajayi.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>